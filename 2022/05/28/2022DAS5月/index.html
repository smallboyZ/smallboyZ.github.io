<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ› | Lu1u</title><meta name="keywords" content="WER,CEF,LuaJIT"><meta name="author" content="Lu1u"><meta name="copyright" content="Lu1u"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="DAS5æœˆåç‰¢å¤§èµ›åæ€">
<meta property="og:type" content="article">
<meta property="og:title" content="DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ›">
<meta property="og:url" content="http://example.com/2022/05/28/2022DAS5%E6%9C%88/index.html">
<meta property="og:site_name" content="Lu1u">
<meta property="og:description" content="DAS5æœˆåç‰¢å¤§èµ›åæ€">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/xx.png">
<meta property="article:published_time" content="2022-05-28T13:33:39.954Z">
<meta property="article:modified_time" content="2022-05-28T13:53:58.791Z">
<meta property="article:author" content="Lu1u">
<meta property="article:tag" content="WER">
<meta property="article:tag" content="CEF">
<meta property="article:tag" content="LuaJIT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/xx.png"><link rel="shortcut icon" href="/img/lu1u.png"><link rel="canonical" href="http://example.com/2022/05/28/2022DAS5%E6%9C%88/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?0f01cab8e7de8c05f9158b21e6d25f0c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ›',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-28 21:53:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/lu1u.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">14</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/xx.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Lu1u</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ›</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-05-28T13:33:39.954Z" title="å‘è¡¨äº 2022-05-28 21:33:39">2022-05-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-05-28T13:53:58.791Z" title="æ›´æ–°äº 2022-05-28 21:53:58">2022-05-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-WP/">CTF-WP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">4.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>16åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ›"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>DAS 5æœˆ</h1>
<blockquote>
<p>éš”å¤©å°±è¦è€ƒè¯•ï¼Œå•çº¯æ‘¸äº†æ‘¸ï¼Œçœ‹èƒ½å¦æ‘¸åˆ°å·¥ä½œé‡å°‘çš„ï¼Œäºæ˜¯é€‰æ‹©äº†luajitï¼Œç½‘ä¸Šçš„æ–¹æ³•å‡ ä¹å°è¯•äº†ä¸€éä¹Ÿæ²¡æœ‰è§£å†³æ–¹æ¡ˆï¼Œç‰ˆæœ¬ä¿¡æ¯æ²¡æœ‰ï¼Œluajitè‡ªå¸¦çš„åæ±‡ç¼–å°è¯•æ— æœï¼Œä½“éªŒæå·®ã€‚</p>
</blockquote>
<h2 id="wer">wer</h2>
<h3 id="æ±‚è§£">æ±‚è§£</h3>
<blockquote>
<p>bcfè™šå‡æ§åˆ¶æµï¼ŒçœŸæ­£çš„é€»è¾‘ä¸åœ¨mainï¼Œè€Œæ˜¯åœ¨æŸä¸ªå‡½æ•°å†…å¯¹è¾“å…¥è¿›è¡Œäº†è½¬å­˜ï¼Œä¹‹ååˆè¿›è¡Œäº†ç›¸å…³å¤„ç†ã€‚</p>
</blockquote>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527091239631.png" alt="image-20220527091239631"></p>
<p>ç›´æ¥å®šä½åˆ°è¾“å…¥éƒ¨åˆ†ï¼Œè¦æ±‚è¾“å…¥ä¸º38ä½å¹¶ä¸”å°†è¾“å…¥å­˜å…¥ä¸¤ä¸ªxmmwordä¸‹ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527091852751.png" alt="image-20220527091852751"></p>
<p>è·Ÿè¿›<code>sub_1400DB50</code>,a2ä¸­å­˜æ”¾çš„æˆ‘ä»¬çš„è¾“å…¥ï¼Œå¯è§å¯¹è¾“å…¥è¿›è¡Œäº†è½¬ç§»ï¼Œä¹‹åå¯¹<code>xmmword_140035C20</code>äº¤å‰å¼•ç”¨ï¼Œå®šä½åˆ°ä¸€ä¸ªæ–°çš„å¤„ç†å‡½æ•°ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527092129863.png" alt="image-20220527092129863"></p>
<p>checké€»è¾‘ä¸º input[i]^v3[i]==102 ,å¾ªç¯32æ¬¡å¦‚æœæˆåŠŸå°±è¾“å‡ºcorrectã€‚</p>
<p><code>exp</code></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="number">0x05</span>, <span class="number">0x03</span>, <span class="number">0x55</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x07</span>, <span class="number">0x5E</span>, <span class="number">0x54</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x50</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x53</span>, <span class="number">0x5F</span>, <span class="number">0x50</span>, <span class="number">0x53</span>, <span class="number">0x50</span>, <span class="number">0x53</span>, <span class="number">0x05</span>, <span class="number">0x55</span>, <span class="number">0x00</span>, <span class="number">0x54</span>, <span class="number">0x55</span>, <span class="number">0x57</span>, <span class="number">0x03</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x52</span>, <span class="number">0x50</span>, <span class="number">0x51</span>, <span class="number">0x53</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    enc[i]^=<span class="number">102</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">b'flag{'</span>+<span class="built_in">bytes</span>(enc)+<span class="string">b'}'</span>)</span><br><span class="line"><span class="comment">#flag{ce3cba82ca6de596565c3f231ecd4675}</span></span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>ä¸‹æ¬¡æ—¶é—´ç´§è¿˜æ˜¯è€è€å®å®æ‘¸windowsäº†ï¼Œä¸æ‘¸ä¸ç†Ÿæ‚‰çš„é¢†åŸŸã€‚ğŸ˜­ğŸ˜­ğŸ˜­</p>
</blockquote>
<h3 id="æº¯æº">æº¯æº</h3>
<p>æŸ¥é˜…<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/wer/windows-error-reporting">Windows é”™è¯¯æŠ¥å‘Š - Win32 åº”ç”¨|å¾®è½¯æ–‡æ¡£ (microsoft.com)</a>å®˜æ–¹æ–‡æ¡£ï¼Œäº†è§£WERå’ŒARR(ç¨‹åºæ¢å¤å’Œé‡å¯)çš„ç›¸å…³çŸ¥è¯†ã€‚</p>
<blockquote>
<p>é”™è¯¯æŠ¥å‘ŠåŠŸèƒ½ä½¿ç”¨æˆ·èƒ½å¤Ÿé€šçŸ¥å¾®è½¯æœ‰å…³åº”ç”¨ç¨‹åºæ•…éšœã€å†…æ ¸æ•…éšœã€æ— ååº”çš„åº”ç”¨ç¨‹åºå’Œå…¶ä»–åº”ç”¨ç¨‹åºçš„å…·ä½“é—®é¢˜ã€‚å¹¶ä¸”å¯ä»¥ä½¿ç”¨åº”ç”¨ç¨‹åºæ¢å¤å’Œé‡å¯(ARR)ï¼Œä»¥ç¡®ä¿å®¢æˆ·åœ¨å…¶åº”ç”¨ç¨‹åºå´©æºƒæ—¶ä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œå¹¶å…è®¸ç”¨æˆ·å¿«é€Ÿè¿”å›åˆ°ä»–ä»¬çš„ä»»åŠ¡ã€‚</p>
</blockquote>
<p>å¯¹getflagçš„ä¸»è¦å‡½æ•°è¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œè§‚å¯Ÿå‡½æ•°è°ƒç”¨çš„å…³ç³»ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527124229347.png" alt="image-20220527124229347"></p>
<p><strong>é¦–å…ˆatexitæ³¨å†Œäº†ç»ˆæ­¢å‡½æ•°ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ³¨å†Œç»ˆæ­¢å‡½æ•°ï¼Œå¹¶ä¸”ä»–åœ¨ç¨‹åºç»“æŸæ—¶è°ƒç”¨ã€‚</strong></p>
<p>å¹¶ä¸”æ³¨å†Œæ˜¯åœ¨mainå‡½æ•°è¿è¡Œå‰å®Œæˆçš„ã€‚</p>
<blockquote>
<p>inittermå‡½æ•°è´Ÿè´£éå†å‡½æ•°æŒ‡é’ˆè¡¨å¹¶åˆå§‹åŒ–å®ƒä»¬çš„å†…éƒ¨æ–¹æ³•ã€‚</p>
</blockquote>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527125654996.png" alt="image-20220527125654996"></p>
<blockquote>
<p>è¿™ä¸ªç‰¹æ€§ä¸ºå…¶èƒ½éšè—æ§åˆ¶æµï¼Œå·å¤©æ¢æ—¥ï¼Œå›¾ç©·è€ŒåŒ•ä¸è§æä¾›äº†æ”¯æ’‘ã€‚</p>
</blockquote>
<p>å…¶æ¬¡æ˜¯æ³¨å†Œäº†<strong>æ¢å¤å›è°ƒå‡½æ•°</strong></p>
<p>å¦‚æœåº”ç”¨ç¨‹åºé‡åˆ°æœªå¤„ç†çš„å¼‚å¸¸æˆ–å˜å¾—æ— å“åº”ï¼ŒWindows é”™è¯¯æŠ¥å‘Š ï¼ˆWERï¼‰ å°†è°ƒç”¨æŒ‡å®šçš„æ¢å¤å›è°ƒã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HRESULT <span class="title">RegisterApplicationRecoveryCallback</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in]           APPLICATION_RECOVERY_CALLBACK pRecoveyCallback, <span class="comment">//æ¢å¤å‡½æ•°æŒ‡é’ˆ</span></span></span></span><br><span class="line"><span class="params"><span class="function">  [in, optional] PVOID                         pvParameter,      <span class="comment">//ä¼ é€’å˜é‡çš„æŒ‡é’ˆï¼Œå¯ä¸ºç©º</span></span></span></span><br><span class="line"><span class="params"><span class="function">  [in]           DWORD                         dwPingInterval,   <span class="comment">//æ¢å¤ ping é—´éš”ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œå¿…é¡»è¦åœ¨è¿™ä¸ªé—´éš”å†…è°ƒç”¨ApplicationRecoveryInProgresså‡½æ•°æ¥è¯´æ˜æ­£åœ¨ä¸»åŠ¨æ¢å¤ï¼Œå¦åˆ™ä¼šè¢«werç»ˆæ­¢ã€‚</span></span></span></span><br><span class="line"><span class="params"><span class="function">  [in]           DWORD                         dwFlags           <span class="comment">//ç›®å‰æ— æ„ä¹‰</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"></span><br><span class="line">ApplicationRecoveryInProgress(&amp;pbCancelled);<span class="comment">// æŒ‡ç¤ºè°ƒç”¨åº”ç”¨ç¨‹åºæ­£åœ¨ç»§ç»­æ¢å¤æ•°æ®ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="function">HRESULT <span class="title">ApplicationRecoveryInProgress</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [out] PBOOL pbCancelled    <span class="comment">//ç”¨æˆ·æ˜¯å¦å–æ¶ˆæ¢å¤ï¼Œç”±werè®¾ç½® ;å–æ¶ˆæ¢å¤/æ¢å¤å®Œæˆæ—¶ pbCancelledä¸º1</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ApplicationRecoveryFinished</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  [in] BOOL bSuccess          <span class="comment">//æ¢å¤æˆåŠŸè¾“å…¥ä¸º1 ä¸æˆåŠŸä¸º0</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>;</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p><code>æ³¨å†Œå‡½æ•°</code></p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall <span class="title">sub_14000F4A0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  HWND ForegroundWindow; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  ForegroundWindow = GetForegroundWindow();     <span class="comment">//æ£€ç´¢å‰å°çª—å£çš„å¥æŸ„ï¼ˆç”¨æˆ·å½“å‰æ­£åœ¨ä½¿ç”¨çš„çª—å£ï¼‰</span></span><br><span class="line">  WerReportHang(ForegroundWindow, <span class="number">0</span>i64);        <span class="comment">// werå‡½æ•°ï¼Œåœ¨æŒ‡å®šçš„çª—å£ä¸Šå¯åŠ¨â€œæ— å“åº”â€æŠ¥å‘Šã€‚</span></span><br><span class="line">  sub_14000F490(); <span class="comment">//æ²¡æœ‰æ‰§è¡Œåˆ° è¿›ç¨‹å°±ç»“æŸäº†</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.text:<span class="number">000000014000F</span>490 sub_14000F490   proc near               ; CODE XREF: sub_14000F4A0+<span class="number">19</span>â†“j</span><br><span class="line">.text:<span class="number">000000014000F</span>490                                         ; DATA XREF: .pdata:<span class="number">0000000140036894</span>â†“o</span><br><span class="line">.text:<span class="number">000000014000F</span>490 ; __unwind { <span class="comment">// sub_140010E50</span></span><br><span class="line">.text:<span class="number">000000014000F</span>490                 <span class="keyword">xor</span>     ecx, ecx</span><br><span class="line">.text:<span class="number">000000014000F</span>492                 mov     eax, <span class="number">61</span>h ; <span class="string">'a'</span></span><br><span class="line">.text:<span class="number">000000014000F</span>497                 mov     [rcx], ax    <span class="comment">//å†…å­˜åœ°å€0æ˜¯æœªåˆ†é…çš„åŒºåŸŸ ä¼šå¼•å‘å†…å­˜è®¿é—®å¼‚å¸¸</span></span><br><span class="line">.text:<span class="number">000000014000F</span>49A                 retn</span><br><span class="line">.text:<span class="number">000000014000F</span>49A ; } <span class="comment">// starts at 14000F490</span></span><br><span class="line">.text:<span class="number">000000014000F</span>49A sub_14000F490   endp</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>å› ä¸ºWindowsä¼šè‡ªåŠ¨æŠ¥å‘Šæœªå¤„ç†çš„å¼‚å¸¸ï¼Œåº”ç”¨ç¨‹åºä¸åº”è¯¥å¤„ç†è‡´å‘½çš„å¼‚å¸¸ã€‚</p>
<p>å¦‚æœå‡ºç°æ•…éšœæˆ–ä¸å“åº”çš„è¿›ç¨‹æ˜¯äº¤äº’å¼çš„ï¼ŒWERä¼šæ˜¾ç¤ºä¸€ä¸ªç”¨æˆ·ç•Œé¢ï¼Œå‘ŠçŸ¥ç”¨æˆ·è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¦‚æœåœ¨ç”¨æˆ·è¯•å›¾ä¸åº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’æ—¶ï¼Œåº”ç”¨ç¨‹åºåœ¨äº”ç§’é’Ÿå†…ä¸å“åº”Windowsæ¶ˆæ¯ï¼Œåˆ™è¢«è®¤ä¸ºæ˜¯æ— å“åº”çš„ã€‚</p>
</blockquote>
<p>å› ä¸ºæˆ‘ä»¬<code>WerReportHang</code>å¯åŠ¨äº†"æ— å“åº”"æŠ¥å‘Šï¼ŒWERä¼šæœ‰ç¨‹åºæœªå“åº”çš„å¼‚å¸¸ï¼Œåœ¨å¼‚å¸¸é€€å‡ºä¹‹å‰ï¼Œè°ƒç”¨æ¢å¤å›è°ƒã€‚</p>
<ol>
<li>ä½¿ç”¨æ¢å¤å›è°ƒå°è¯•åœ¨åº”ç”¨ç¨‹åºç»ˆæ­¢ä¹‹å‰ä¿å­˜æ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚ ç„¶åï¼Œå¯ä»¥åœ¨é‡å¯åº”ç”¨ç¨‹åºæ—¶ä½¿ç”¨ä¿å­˜çš„æ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚</li>
<li>æ— å“åº”æŠ¥å‘Šå®Œæˆåï¼Œå®ƒå°†ç»ˆæ­¢åˆ›å»ºçª—å£çš„è¿›ç¨‹ã€‚è¿™ä¹Ÿæ˜¯è°ƒè¯•åˆ°è¿™ä¸€æ­¥ä¼šæŒ‚æ‰çš„åŸå› ã€‚</li>
</ol>
<p>æ•´ä½“æµç¨‹:  æ³¨å†Œç»ˆæ­¢å‡½æ•°/æ¢å¤å‡½æ•°  -&gt; main(è™šå‡æ§åˆ¶æµç»“æŸ) -&gt; ç»ˆæ­¢å‡½æ•° -&gt; å½“å‰çª—å£å¯åŠ¨"æ— å“åº”"æŠ¥å‘Š -&gt; è§¦å‘å¼‚å¸¸ -&gt; æ¢å¤å‡½æ•°ã€‚</p>
<h2 id="CEF">CEF</h2>
<h3 id="æ±‚è§£-2">æ±‚è§£</h3>
<blockquote>
<p>ç¨‹åºçš„ä¾èµ–æœ‰ç‚¹å¤šï¼Œå½“æ—¶å­˜ä¸‹æ–‡ä»¶å°±æ²¡ç»†çœ‹ï¼Œåæ¥çœ‹ç¾¤#REtardå¸ˆå‚…å‘äº†ä¸€å¼ å›¾ï¼Œçœ‹ç€æœ‰ç‚¹ç†Ÿæ‚‰çš„sm4ï¼Œç»ˆäºè¿˜æ˜¯å¯¹ä»–ä¸‹æ‰‹äº†ã€‚</p>
</blockquote>
<p>è¿è¡Œç¨‹åºï¼Œä¼šæœ‰ä¸€æ®µæŠ¥é”™ï¼Œä¸è¿‡å¯ä»¥æ ¹æ®è¿™ä¸ªæ˜æ–‡ä¿¡æ¯è¿›è¡Œæœç´¢ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527201157512.png" alt="image-20220527201157512"></p>
<p>æŸ¥çœ‹stringsçª—å£ï¼Œäº¤å‰å¼•ç”¨<code>please input your flag</code>å¾—åˆ°çš„ä»£ç é€»è¾‘échecké€»è¾‘ï¼Œåº”è¯¥æ˜¯åœ¨æ³¨å†Œçª—å£ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527201315343.png" alt="image-20220527201315343"></p>
<p>å¯ä»¥åœ¨æ•°æ®æ®µå¯¹å…¶ä»–å¯ç–‘çš„æ•°æ®è¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œå°¤å…¶æ˜¯é•¿åº¦ä¸º32ä½çš„(ç»å…¸flag len)ï¼Œæˆ–è€…æ˜¯åŠ å¯†é€»è¾‘ä¸­éœ€è¦ç”¨çš„æ•°æ®è¡¨ã€‚</p>
<p>å¯ä»¥é€šè¿‡äº¤å‰å¼•ç”¨å®šä½åˆ°<code>sub_44F360</code>å‡½æ•°ï¼Œå…¶ä¸­ä¸€äº›æ˜¾ç¤ºæ˜æ–‡æœ‰å¼‚æˆ–è§£å¯†å¾—åˆ°ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527202145352.png" alt="image-20220527202145352"></p>
<p>è§£å¯†å¯å¾—document.write(â€˜%câ€™); å¹¶ä¸”ä¹‹åå…¶ä»–å­—ç¬¦å¯å¾—alert(â€˜Correctâ€™)ã€‚</p>
<blockquote>
<p>ğŸ˜€ğŸ˜€ğŸ˜€ï¼Œé€šè¿‡è§£å¯†å‡ºçš„ä¸€äº›æ˜æ–‡å­—ç¬¦å’ŒåŠ å¯†é€»è¾‘èµ°å‘ç¡®å®šè¯¥å¤„æ˜¯å…³é”®checkç‚¹ã€‚</p>
</blockquote>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527202548836.png" alt="image-20220527202548836"></p>
<p>è¿™æ­¥é€»è¾‘æ²¡æœ‰æ¶‰åŠè¾“å…¥ï¼Œå¦‚æœæœ‰äº†è§£è¿‡<a target="_blank" rel="noopener" href="https://github.com/smallboyZ/Reverse_Crypto/blob/main/SM4/sm4.c">SM4 - mygithub</a>åŠ å¯†çš„è¯ï¼Œå¯ä»¥çœ‹å‡ºä»–å¤§è‡´ä¸ºç§˜é’¥æ‰©å±•çš„è¿‡ç¨‹ï¼Œç”±TKç”ŸæˆCK(è½®ç§˜é’¥)ï¼Œä¸è¿‡è¿›è¡Œäº†ç®€åŒ–æ²¡æœ‰sboxçš„æ›¿æ¢è¿‡ç¨‹ã€‚</p>
<blockquote>
<p>å¹¶ä¸”å‡ºé¢˜äººå¯¹ç»†èŠ‚å¤„ç†æ¯”è¾ƒå¥½ï¼Œå¯¹ç©ºé—´è¿›è¡Œäº†ä¼˜åŒ–ï¼Œé€šè¿‡æ¨¡è¿ç®—æ¥ä½¿è½®ç§˜é’¥çš„ç”Ÿæˆæ›´èŠ‚çœç©ºé—´ã€‚</p>
</blockquote>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sm4_exkey</span><span class="params">(<span class="keyword">uint32_t</span>*mkey)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) { <span class="comment">//åˆå§‹ç§˜é’¥å¼‚æˆ–FK</span></span><br><span class="line">        mkey[i] ^= FK[i];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    rK = (<span class="keyword">uint32_t</span>*)(mkey + <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) {</span><br><span class="line">        <span class="keyword">uint32_t</span> tmp = mkey[i + <span class="number">1</span>] ^ mkey[i + <span class="number">2</span>] ^ mkey[i + <span class="number">3</span>] ^ CK[i];</span><br><span class="line">        sbox_replace(&amp;tmp);      </span><br><span class="line">        rK[i]=mkey[i]^L2(tmp);</span><br><span class="line">    } </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>pythonæ¨¡æ‹Ÿå®ç°å¦‚ä¸‹</p>
<blockquote>
<p>å‘½åå¯èƒ½æœ‰äº›å·®å¼‚ï¼Œä¸»è¦æ˜¯åŠ å¯†æµç¨‹ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rol</span>(<span class="params">n,x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (n&lt;&lt;x | n&gt;&gt;(<span class="number">32</span>-x))&amp;<span class="number">0xffffffff</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ror</span>(<span class="params">n,x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (n&gt;&gt;x | n&lt;&lt;(<span class="number">32</span>-x))&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x=[<span class="number">0xA3B1BAC6</span>, <span class="number">0x56AA3350</span>, <span class="number">0x677D9197</span>, <span class="number">0xB27022DC</span>]</span><br><span class="line">s=[<span class="number">0x12345678</span>, <span class="number">0x90ABCDEF</span>, <span class="number">0xFEDCBA09</span>, <span class="number">0x87654321</span>]</span><br><span class="line">block=[x[i]^s[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">tb=[<span class="number">0x00070E15</span>, <span class="number">0x1C232A31</span>, <span class="number">0x383F464D</span>, <span class="number">0x545B6269</span>, <span class="number">0x70777E85</span>, <span class="number">0x8C939AA1</span>, <span class="number">0xA8AFB6BD</span>, <span class="number">0xC4CBD2D9</span>, <span class="number">0xE0E7EEF5</span>, <span class="number">0xFC030A11</span>, <span class="number">0x181F262D</span>, <span class="number">0x343B4249</span>, <span class="number">0x50575E65</span>, <span class="number">0x6C737A81</span>, <span class="number">0x888F969D</span>, <span class="number">0xA4ABB2B9</span>, <span class="number">0xC0C7CED5</span>, <span class="number">0xDCE3EAF1</span>, <span class="number">0xF8FF060D</span>, <span class="number">0x141B2229</span>, <span class="number">0x30373E45</span>, <span class="number">0x4C535A61</span>, <span class="number">0x686F767D</span>, <span class="number">0x848B9299</span>, <span class="number">0xA0A7AEB5</span>, <span class="number">0xBCC3CAD1</span>, <span class="number">0xD8DFE6ED</span>, <span class="number">0xF4FB0209</span>, <span class="number">0x10171E25</span>, <span class="number">0x2C333A41</span>, <span class="number">0x484F565D</span>, <span class="number">0x646B7279</span>] <span class="comment">#å…¶å®è¿™æ˜¯SM4æ ‡å‡†çš„CK</span></span><br><span class="line"></span><br><span class="line">ck=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v11=tb[i]^block[(i+<span class="number">1</span>)%<span class="number">4</span>]^block[(i+<span class="number">2</span>)%<span class="number">4</span>]^block[(i+<span class="number">3</span>)%<span class="number">4</span>]</span><br><span class="line">    t=v11^ror(v11,<span class="number">9</span>)^rol(v11,<span class="number">13</span>)</span><br><span class="line">    block[i%<span class="number">4</span>]=block[i%<span class="number">4</span>]^t</span><br><span class="line">    ck.append(block[i%<span class="number">4</span>])</span><br></pre></td></tr></tbody></table></figure>
<p>ä¹‹åå¯ä»¥è§‚å¯Ÿåˆ°è°ƒç”¨äº†CK_table,å¹¶ä¸”å°†è¾“å…¥4ä¸ªä¸€ç»„è½¬ä¸ºDWORDç±»å‹ï¼Œä¹‹åè°ƒç”¨<code>sub_4520E0</code>è¿›è¡ŒåŠ å¯†ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527204027178.png" alt="image-20220527204027178"></p>
<p><code>sub_4520E0</code>å‡½æ•°åŠ å¯†ä¸»ä½“å¦‚ä¸‹</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527204401527.png" alt="image-20220527204401527"></p>
<p>è¿‡ç¨‹ä¸ç§˜é’¥æ‰©å±•ç±»ä¼¼ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mstr=[<span class="number">0</span>]*<span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v3=ck[i]^mstr[(i+<span class="number">1</span>)%<span class="number">4</span>]^mstr[(i+<span class="number">2</span>)%<span class="number">4</span>]^mstr[(i+<span class="number">3</span>)%<span class="number">4</span>]</span><br><span class="line">    t=v3^rol(v3,<span class="number">2</span>)^ror(v3,<span class="number">8</span>)^rol(v3,<span class="number">10</span>)^ror(v3,<span class="number">14</span>)</span><br><span class="line">    mstr[i%<span class="number">4</span>]=mstr[i%<span class="number">4</span>]^t</span><br></pre></td></tr></tbody></table></figure>
<p>ä¹‹åå†èµ‹å€¼æ—¶ï¼ŒBlock[0-3] åˆ†åˆ«å¯¹åº” v42ã€v41ã€v40ã€v39ï¼Œä¹‹åå­˜åˆ°CK[5]å¼€å§‹çš„åœ°å€ï¼Œæ‰€ä»¥åœ¨äºŒè½®è§£å¯†æ—¶ckçš„4ä¸ªæ•°æ®è¢«æ›¿æ¢ã€‚</p>
<p>ç»¼ä¸Šï¼Œè§£å¯†æµç¨‹å¦‚ä¸‹ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rol</span>(<span class="params">n,x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (n&lt;&lt;x | n&gt;&gt;(<span class="number">32</span>-x))&amp;<span class="number">0xffffffff</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ror</span>(<span class="params">n,x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (n&gt;&gt;x | n&lt;&lt;(<span class="number">32</span>-x))&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x=[<span class="number">0xA3B1BAC6</span>, <span class="number">0x56AA3350</span>, <span class="number">0x677D9197</span>, <span class="number">0xB27022DC</span>]</span><br><span class="line">s=[<span class="number">0x12345678</span>, <span class="number">0x90ABCDEF</span>, <span class="number">0xFEDCBA09</span>, <span class="number">0x87654321</span>]</span><br><span class="line">block=[x[i]^s[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">tb=[<span class="number">0x00070E15</span>, <span class="number">0x1C232A31</span>, <span class="number">0x383F464D</span>, <span class="number">0x545B6269</span>, <span class="number">0x70777E85</span>, <span class="number">0x8C939AA1</span>, <span class="number">0xA8AFB6BD</span>, <span class="number">0xC4CBD2D9</span>, <span class="number">0xE0E7EEF5</span>, <span class="number">0xFC030A11</span>, <span class="number">0x181F262D</span>, <span class="number">0x343B4249</span>, <span class="number">0x50575E65</span>, <span class="number">0x6C737A81</span>, <span class="number">0x888F969D</span>, <span class="number">0xA4ABB2B9</span>, <span class="number">0xC0C7CED5</span>, <span class="number">0xDCE3EAF1</span>, <span class="number">0xF8FF060D</span>, <span class="number">0x141B2229</span>, <span class="number">0x30373E45</span>, <span class="number">0x4C535A61</span>, <span class="number">0x686F767D</span>, <span class="number">0x848B9299</span>, <span class="number">0xA0A7AEB5</span>, <span class="number">0xBCC3CAD1</span>, <span class="number">0xD8DFE6ED</span>, <span class="number">0xF4FB0209</span>, <span class="number">0x10171E25</span>, <span class="number">0x2C333A41</span>, <span class="number">0x484F565D</span>, <span class="number">0x646B7279</span>]</span><br><span class="line"></span><br><span class="line">ck=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v11=tb[i]^block[(i+<span class="number">1</span>)%<span class="number">4</span>]^block[(i+<span class="number">2</span>)%<span class="number">4</span>]^block[(i+<span class="number">3</span>)%<span class="number">4</span>]</span><br><span class="line">    t=v11^ror(v11,<span class="number">9</span>)^rol(v11,<span class="number">13</span>)</span><br><span class="line">    block[i%<span class="number">4</span>]=block[i%<span class="number">4</span>]^t</span><br><span class="line">    ck.append(block[i%<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="string">""" encry</span></span><br><span class="line"><span class="string">mstr=[0]*32</span></span><br><span class="line"><span class="string">for i in range(32):</span></span><br><span class="line"><span class="string">    v3=ck[i]^mstr[(i+1)%4]^mstr[(i+2)%4]^mstr[(i+3)%4]</span></span><br><span class="line"><span class="string">    t=v3^rol(v3,2)^ror(v3,8)^rol(v3,10)^ror(v3,14)</span></span><br><span class="line"><span class="string">    mstr[i%4]=mstr[i%4]^t</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decry</span>(<span class="params">enc</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        v3 = ck[i] ^ enc[(i + <span class="number">1</span>) % <span class="number">4</span>] ^ enc[(i + <span class="number">2</span>) % <span class="number">4</span>] ^ enc[(i + <span class="number">3</span>) % <span class="number">4</span>]</span><br><span class="line">        t = v3 ^ rol(v3, <span class="number">2</span>) ^ ror(v3, <span class="number">8</span>) ^ rol(v3, <span class="number">10</span>) ^ ror(v3, <span class="number">14</span>)</span><br><span class="line">        enc[i % <span class="number">4</span>] = enc[i % <span class="number">4</span>] ^ t</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enc=[<span class="number">0xC0CB547D</span>, <span class="number">0xD7F5DB74</span>, <span class="number">0x1B92D96F</span>, <span class="number">0x204628EB</span>, <span class="number">0x60D3D5E5</span>, <span class="number">0x2F366D80</span>, <span class="number">0x612F63B0</span>, <span class="number">0x30A90F20</span>]</span><br><span class="line">c1=enc[:<span class="number">4</span>][::-<span class="number">1</span>]</span><br><span class="line">decry(c1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">int</span>.to_bytes(c1[i], <span class="number">4</span>, <span class="string">'little'</span>).decode(),end=<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    ck[<span class="number">5</span>+i]=enc[i]</span><br><span class="line"></span><br><span class="line">c2=enc[<span class="number">4</span>:][::-<span class="number">1</span>]</span><br><span class="line">decry(c2)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">int</span>.to_bytes(c2[i], <span class="number">4</span>, <span class="string">'little'</span>).decode(),end=<span class="string">''</span>)</span><br><span class="line"><span class="comment">#flag{3b2365b04700b5eac3a5fd0ba21b687f}</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ˜¾ç¤ºçš„æ— æ³•æ‰“å¼€urlï¼Œå®é™…è¾“å…¥è§£å¯†çš„å­—ç¬¦å´æœ‰å›æ˜¾ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220527210629834.png" alt="image-20220527210629834"></p>
<h3 id="æº¯æº-2">æº¯æº</h3>
<blockquote>
<p><code>CEF</code>æ˜¯<code>Chromium Embedded Framework</code>çš„ç¼©å†™ï¼Œå³â€œChromiumåµŒå…¥å¼æ¡†æ¶â€ï¼Œé‡‡ç”¨c++ç¼–å†™ï¼Œåœ°ä½ç±»ä¼¼äºElectronï¼Œæ˜¯webå¼€å‘åº”ç”¨ç¨‹åºçš„é‡è¦æ¡†æ¶ã€‚</p>
</blockquote>
<p>ç›®å½•ç‰¹å¾</p>
<figure class="highlight tex"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cef.pak</span><br><span class="line">cef<span class="built_in">_</span>100<span class="built_in">_</span>percent.pak</span><br><span class="line">cef<span class="built_in">_</span>200<span class="built_in">_</span>percent.pak</span><br><span class="line">libcef.dll</span><br></pre></td></tr></tbody></table></figure>
<p>cefä½¿ç”¨å¤šè¿›ç¨‹ï¼Œä¸»è¿›ç¨‹ä¸º"æµè§ˆå™¨è¿›ç¨‹"ï¼Œå¹¶ä¸”ä»–å®ç°çš„åŠŸèƒ½å°±æ˜¯å°†Chromium çš„æµè§ˆå™¨åµŒå…¥åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚</p>
<p>cefåº”ç”¨ç¨‹åºdemoé»˜è®¤åŠ è½½<code>google.com</code>,å½“ç„¶è¿™ä¸ªurlå¯ä»¥åˆ‡æ¢ä¸ºæœ¬åœ°æ–‡ä»¶ã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŠ è½½æœ¬åœ°æ–‡ä»¶â€œc:\example\example.htmlâ€ </span></span><br><span class="line">... </span><br><span class="line"><span class="keyword">if</span> (url.empty()) </span><br><span class="line">  url = <span class="string">"file://c:/example/example.html"</span>; </span><br><span class="line">â€¦</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>æœ¬é¢˜urlè®¾ç½®çš„please input your flag å½“ç„¶æ˜¯é”™è¯¯çš„æ— æ³•åŠ è½½é¡µé¢ã€‚</p>
</blockquote>
<p>å…¥å£ç‚¹å‡½æ•°</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"include/cef_command_line.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"include/cef_sandbox_win.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"tests/cefsimple/simple_app.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// When generating projects with CMake the CEF_USE_SANDBOX value will be defined</span></span><br><span class="line"><span class="comment">// automatically if using the required compiler version. Pass -DUSE_SANDBOX=OFF</span></span><br><span class="line"><span class="comment">// to the CMake command-line to disable use of the sandbox.</span></span><br><span class="line"><span class="comment">// Uncomment this line to manually enable sandbox support.</span></span><br><span class="line"><span class="comment">// #define CEF_USE_SANDBOX 1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(CEF_USE_SANDBOX)</span></span><br><span class="line"><span class="comment">// The cef_sandbox.lib static library may not link successfully with all VS</span></span><br><span class="line"><span class="comment">// versions.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib, <span class="meta-string">"cef_sandbox.lib"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Entry point function for all processes.</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> APIENTRY <span class="title">wWinMain</span><span class="params">(HINSTANCE hInstance,</span></span></span><br><span class="line"><span class="params"><span class="function">                      HINSTANCE hPrevInstance,</span></span></span><br><span class="line"><span class="params"><span class="function">                      LPTSTR lpCmdLine,</span></span></span><br><span class="line"><span class="params"><span class="function">                      <span class="keyword">int</span> nCmdShow)</span> </span>{</span><br><span class="line">  UNREFERENCED_PARAMETER(hPrevInstance);</span><br><span class="line">  UNREFERENCED_PARAMETER(lpCmdLine);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Enable High-DPI support on Windows 7 or newer.</span></span><br><span class="line">  CefEnableHighDPISupport();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span>* sandbox_info = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(CEF_USE_SANDBOX)</span></span><br><span class="line">  <span class="comment">// Manage the life span of the sandbox information object. This is necessary</span></span><br><span class="line">  <span class="comment">// for sandbox support on Windows. See cef_sandbox_win.h for complete details.</span></span><br><span class="line">  CefScopedSandboxInfo scoped_sandbox;</span><br><span class="line">  sandbox_info = scoped_sandbox.sandbox_info();</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Provide CEF with command-line arguments.</span></span><br><span class="line">  <span class="function">CefMainArgs <span class="title">main_args</span><span class="params">(hInstance)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> CEFåº”ç”¨ç¨‹åºæœ‰å¤šä¸ªå­è¿›ç¨‹ï¼ˆæ¸²æŸ“ã€GPUç­‰ï¼‰ï¼Œå…±äº«åŒä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™ä¸ªå‡½æ•°æ£€æŸ¥å‘½ä»¤è¡Œï¼Œå¦‚æœè¿™æ˜¯ä¸ª ä¸€ä¸ªå­è¿›ç¨‹ï¼Œåˆ™æ‰§è¡Œé€‚å½“çš„é€»è¾‘ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">  <span class="keyword">int</span> exit_code = CefExecuteProcess(main_args, <span class="literal">nullptr</span>, sandbox_info);</span><br><span class="line">  <span class="keyword">if</span> (exit_code &gt;= <span class="number">0</span>) {</span><br><span class="line">    <span class="comment">// The sub-process has completed so return here.</span></span><br><span class="line">    <span class="keyword">return</span> exit_code;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Parse command-line arguments for use in this method.</span></span><br><span class="line">  CefRefPtr&lt;CefCommandLine&gt; command_line = CefCommandLine::CreateCommandLine();</span><br><span class="line">  command_line-&gt;InitFromString(::GetCommandLineW());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Specify CEF global settings here.</span></span><br><span class="line">  CefSettings settings;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (command_line-&gt;HasSwitch(<span class="string">"enable-chrome-runtime"</span>)) {</span><br><span class="line">    <span class="comment">// Enable experimental Chrome runtime. See issue #2969 for details.</span></span><br><span class="line">    settings.chrome_runtime = <span class="literal">true</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined(CEF_USE_SANDBOX)</span></span><br><span class="line">  settings.no_sandbox = <span class="literal">true</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// SimpleApp implements application-level callbacks for the browser process.</span></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  å®ƒå°†åœ¨CEFåˆå§‹åŒ–åçš„OnContextInitialized()ä¸­åˆ›å»ºç¬¬ä¸€ä¸ªæµè§ˆå™¨å®ä¾‹ã€‚</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="function">CefRefPtr&lt;SimpleApp&gt; <span class="title">app</span><span class="params">(<span class="keyword">new</span> SimpleApp)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–CEF</span></span><br><span class="line">  CefInitialize(main_args, settings, app.get(), sandbox_info);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Run the CEF message loop. This will block until CefQuitMessageLoop() is</span></span><br><span class="line">  <span class="comment">// called.</span></span><br><span class="line">  CefRunMessageLoop();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Shut down CEF.</span></span><br><span class="line">  CefShutdown();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è‡³äºä¸€äº›å›è°ƒå‡½æ•°å’Œæ›´è¯¦ç»†çš„å®ä¾‹å¯ä»¥ç»“åˆ<a target="_blank" rel="noopener" href="https://bitbucket.org/chromiumembedded/cef/wiki/Tutorial.md">CEF-WIKI</a>æä¾›çš„demoæºç è¿›è¡Œè°ƒè¯•å’Œå­¦ä¹ ã€‚</p>
<blockquote>
<p>å¤§è‡´äº†è§£æµç¨‹ï¼Œè¿™ä¸ªæ¡†æ¶è¿˜æ˜¯æ¯”è¾ƒæœ‰è¶£çš„ï¼Œä¹‹åå¯ä»¥æ·±å…¥å­¦ä¹ ä¸€ä¸‹:)ã€‚</p>
</blockquote>
<h4 id="å°æ’æ›²">å°æ’æ›²</h4>
<p>å¯¹è§£å¯†å‡ºçš„js apiæ˜¯å¦æ„Ÿåˆ°å¼‚æˆ–ï¼Œæœç´¢CEFé€›çœ‹é›ªæ—¶æ‰åˆ°äº†å‡ºé¢˜äººçš„èº«å½±ã€‚</p>
<blockquote>
<p>ä¸è¿‡æœ¬é¢˜æ¥è¯´æ˜¯cefç›´æ¥è°ƒç”¨jsçš„ï¼Œå¹¶éé‡‡ç”¨çš„ä»¥ä¸‹æŠ€æœ¯æ‰‹æ®µã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-268570.htm">å°†jsä»£ç æ³¨å…¥åˆ°ç¬¬ä¸‰æ–¹CEFåº”ç”¨ç¨‹åºçš„ä¸€ç‚¹æµ…è§-ç¼–ç¨‹æŠ€æœ¯-çœ‹é›ªè®ºå›-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|bbs.pediy.com</a></p>
<p>è¯¥æ–‡ä½œè€…æŠ“ä½CEFç¨‹åºåˆ›å»ºæµè§ˆå™¨çš„ç‰¹ç‚¹ï¼Œè¯•å›¾æ‰¾åˆ°ç”Ÿæˆçš„æµè§ˆå™¨å¯¹è±¡ï¼Œä»¥æ­¤æ¥ä»»æ„æ‰§è¡Œjsä»£ç ã€‚</p>
<blockquote>
<p>cef çš„æ ¸å¿ƒå…¨éƒ¨åœ¨libcef.dllé‡Œï¼Œæ‰€ä»¥ä»å…¶ä¸­åˆ›å»ºæµè§ˆå™¨çš„APIå…¥æ‰‹ï¼Œä¸ºäº†æ‹¿åˆ°åˆ›å»ºå‡ºçš„æµè§ˆå™¨å¯¹è±¡ã€‚</p>
</blockquote>
<p><strong>å°è¯•</strong></p>
<p>æ‰¾åˆ°åˆ›å»ºæµè§ˆå™¨çš„APIï¼Œè¿›è¡Œhookæ‹¿åˆ°æµè§ˆå™¨å¯¹è±¡ã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cef_browser_host_create_browser</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">const</span> <span class="keyword">cef_window_info_t</span>* windowInfo,</span></span></span><br><span class="line"><span class="params"><span class="function">    struct <span class="keyword">_cef_client_t</span>* client,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">const</span> <span class="keyword">cef_string_t</span>* url,</span></span></span><br><span class="line"><span class="params"><span class="function">    struct <span class="keyword">_cef_browser_settings_t</span>* settings,</span></span></span><br><span class="line"><span class="params"><span class="function">    struct <span class="keyword">_cef_request_context_t</span>* request_context)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p>è€Œè¿™ä¸ªå‡½æ•°æ˜¯å¼‚æ­¥,æ‰€ä»¥<code>cef_browser_t*</code>å­˜åœ¨äºåˆ›å»ºæˆåŠŸçš„å›è°ƒä¸­ï¼Œä½œè€…ä¹‹ååˆé€šè¿‡<code>_cef_client_t* client</code>å‚æ•°å…¥æ‰‹å»hookå›è°ƒï¼Œä½†æœ€ç»ˆä»¥å¤±è´¥å‘Šç»ˆã€‚</p>
<p>åŒæ­¥å’Œå¼‚æ­¥å¤ä¹ <a target="_blank" rel="noopener" href="https://www.cnblogs.com/IT-CPC/p/10898871.html">åŒæ­¥(Synchronous)å’Œå¼‚æ­¥(Asynchronous) - myCpC - åšå®¢å›­ (cnblogs.com)</a></p>
<p><strong>æŸ³æš—èŠ±æ˜</strong></p>
<p>å¸ˆå‚…åˆé€šè¿‡è§‚å¯Ÿlibcefçš„å…¶ä»–APIï¼Œæ‰¾åˆ°äº†çªç ´å£ã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">// Returns the current (top) context object in the V8 context stack.</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="function">CEF_EXPORT <span class="keyword">cef_v8context_t</span>* <span class="title">cef_v8context_get_current_context</span><span class="params">()</span></span>; <span class="comment">//è¿”å›V8å¼•æ“çš„ä¸Šä¸‹æ–‡</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä»‹äºV8jsä¸browseræ˜¯ç»‘å®šçš„ï¼Œæ‰€ä»¥å€ŸåŠ©v8jså¼•æ“çš„ä¸Šä¸‹æ–‡æ¥æ‹¿åˆ°browserå¯¹è±¡ã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cef_browser_t</span>* browser = <span class="literal">NULL</span>;</span><br><span class="line"><span class="function"><span class="keyword">cef_v8context_t</span>* <span class="title">my_cef_v8context_get_current_context</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">cef_v8context_t</span>* js_context = ori_cef_v8context_get_current_context(); <span class="comment">//è·å–V8jså¼•æ“ä¸Šä¸‹æ–‡</span></span><br><span class="line">    Print(<span class="string">"my_cef_v8context_get_current_context js_context: %X!!\n"</span>, js_context);</span><br><span class="line">    browser = js_context-&gt;get_browser(js_context); <span class="comment">//å¾—åˆ°æµè§ˆå™¨å¯¹è±¡!!!</span></span><br><span class="line">    <span class="comment">//Print("[!!!] browser = %X\n", browser);</span></span><br><span class="line">    <span class="keyword">_cef_frame_t</span>* frame = browser-&gt;get_main_frame(browser);</span><br><span class="line">    <span class="comment">//Print("[!!!] frame = %X\n", frame);</span></span><br><span class="line">    CefString script = payload;</span><br><span class="line">    CefString url = xorstr(<span class="string">"app/wd"</span>).crypt_get();</span><br><span class="line">    frame-&gt;execute_java_script(frame, script.GetStruct(), url.GetStruct(), <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> js_context;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// write by renbohan  https://bbs.pediy.com/thread-268570.htm</span></span><br></pre></td></tr></tbody></table></figure>
<p>è‡³æ­¤ç›®çš„å·²ç»è¾¾æˆï¼Œå³æˆ‘ä»¬æˆåŠŸæ‹¿åˆ°äº†cefåˆ›å»ºå‡ºçš„æµè§ˆå™¨å¯¹è±¡ã€‚æ‰€è°“è¿‡æ²³æ‹†æ¡¥ï¼Œæ‹¿åˆ°è¯¥å¯¹è±¡åå°±å¯ä»¥éå¸¸æ–¹ä¾¿çš„æ‰§è¡Œjsä»£ç ï¼Œä»è€Œcefçš„æ‰“å·¥ç”Ÿæ¶¯ç»“æŸï¼Œjsæ‰æ˜¯checkä»£ç çš„ä¸»åœºã€‚</p>
<h2 id="LuaJit">LuaJit</h2>
<blockquote>
<p>å“¦ï¼Œå¤šä¹ˆç—›çš„é¢†æ‚Ÿ~ğŸ˜±ğŸ˜±ğŸ˜±</p>
</blockquote>
<p>æ‹¿åˆ°æ–‡ä»¶åå¯ä»¥é€šè¿‡010æ‰“å¼€ï¼Œå‘ç°æ˜¯éPEæ–‡ä»¶æ ¼å¼ï¼Œæ ¹æ®æ–‡ä»¶å¤´<code>1B 4C 4A 02</code>æœç´¢å¾—çŸ¥ä¸ºluajitç¼–è¯‘çš„æ–‡ä»¶ã€‚</p>
<p>LuaJIT ä½¿ç”¨äº†ä¸€ç§å…¨æ–°çš„æ–¹å¼æ¥ç¼–è¯‘å’Œæ‰§è¡Œ Lua è„šæœ¬ã€‚ç»è¿‡å¤„ç†åçš„ LuaJIT ç¨‹åºï¼Œå­—èŠ‚ç çš„ç¼–ç å®ç°æ›´åŠ ç®€å•ï¼Œæ‰§è¡Œæ•ˆç‡ç›¸æ¯” Lua å’Œ Luac æ›´åŠ é«˜æ•ˆã€‚</p>
<blockquote>
<p>ç›´æ¥ç™¾åº¦luajité€†å‘ï¼Œä¹‹å‰æ²¡æ¥è§¦è¿‡æ­¤ç±»é€†å‘ï¼Œæ ¼å±€å°äº†ğŸ™ƒã€‚æœ‰å¹¸ä¹‹å‰åœ¨<a target="_blank" rel="noopener" href="https://blog.shi1011.cn/rev/android/1216">ğŸŸå“¥ - Mas0n</a>åšå®¢ä¸Šçœ‹åˆ°è¿‡å‡ ç§luaçš„ä¿æŠ¤æ–¹å¼å’Œè§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<p>å¯ä»¥é€šè¿‡éè™«å¤§ç‰›çš„<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/90241#h3-11">Luaç¨‹åºé€†å‘ä¹‹Luajitå­—èŠ‚ç ä¸åæ±‡ç¼–</a>äº†è§£luajitçš„opcodeç»“æ„å’Œæ–‡ä»¶æ ¼å¼ï¼Œå¹¶ä¸”æä¾›äº†010çš„<code>luajit.bt</code>çš„æ¨¡æ¿ã€‚</p>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220528115928721.png" alt="image-20220528115928721"></p>
<p>å¹¶ä¸”ä¹Ÿç›´æ¥è¿›è¡Œäº†åæ±‡ç¼–ï¼Œå½“ç„¶é˜…è¯»luajitåæ±‡ç¼–ä¹‹åçš„å­—èŠ‚ç ä¹Ÿæ˜¯ä¸€ç§æŠ˜ç£¨ï¼Œäºæ˜¯åœ¨<code>gayhub</code>ä¸Šå››å¤„æœå¯»åç¼–è¯‘çš„è½®å­ï¼Œä¸è¿‡ç»“æœéƒ½ä¸å°½äººæ„ã€‚</p>
<blockquote>
<p>æ€»ç»“: å‰è¾ˆä»¬çš„å·¥å…·å¤§å¤šä¸€è„‰ç›¸æ‰¿ï¼Œæ ¹æ®ç‰ˆæœ¬æ›´æ–°æ·»åŠ æ–°çš„opcodeï¼›åŒæ—¶åªèƒ½åç¼–è¯‘luajitç¼–è¯‘å‡º32ä½çš„æ–‡ä»¶ï¼Œå¯¹64ä½ä¸é€‚ç”¨ã€‚</p>
<p>è€Œä¸”æœ¬é¢˜æ²¡æœ‰ç»™å‡ºluajitçš„å…·ä½“ç‰ˆæœ¬ï¼Œæƒ³é‡‡ç”¨luajitåŸç”Ÿçš„åæ±‡ç¼–å·¥å…·è¿›è¡Œåæ±‡ç¼–éƒ½è¦è‡ªè¡Œæ‘¸ç´¢ç‰ˆæœ¬,ä¸»æµåº”è¯¥åœ¨2.1æˆ–2.0ğŸ˜­ã€‚</p>
</blockquote>
<p>LJDæœ€è¿‘çš„ä¸€ä¸ªé¡¹ç›®**<a target="_blank" rel="noopener" href="https://github.com/Dr-MTN/luajit-decompiler">luajit-decompiler</a>**ï¼ŒçŸ¥é“é¢˜ç›®å¯¹åº”ç‰ˆæœ¬æ‰å¯çŸ¥æ˜¯å¦éœ€è¦æ”¹opcodeï¼Œæˆ–è€…æ˜¯å·¥å…·çš„æœ‰å…³æŠ¥é”™ä¿¡æ¯ã€‚</p>
<p>åˆåœ¨å¾çˆ±ä¸Šçœ‹åˆ°ä¸€ç¯‡åšå®¢<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1378796-1-1.html"><strong>luajitåç¼–è¯‘ã€è§£å¯†</strong></a>,å…¶ä¸­æåˆ°äº†å¦ä¸€ç§å·¥å…·**<a target="_blank" rel="noopener" href="https://github.com/bobsayshilol/luajit-decomp"> luajit-decomp</a>**,æ­¤å·¥å…·ä½¿ç”¨èµ·æ¥åªéœ€ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„luajitå¹¶ç¼–è¯‘ï¼Œæ‹¿åˆ°å…¶ä¸­çš„<code>luajit.exe</code>ã€<code>lua51.dll</code>ã€<code>jitæ–‡ä»¶å¤¹</code>æ”¾åˆ°decompæ–‡ä»¶å¤¹ä¸‹ï¼Œè¿è¡Œjitdecompå³å¯ã€‚</p>
<ol>
<li><code>luajit-decomp\data\luajit</code>ä¸‹å­˜æ”¾å¾…åç¼–è¯‘çš„jitæ–‡ä»¶ã€‚</li>
<li>è¿è¡Œjitdecompï¼Œç»“æœä¼šåœ¨<code>luajit-decomp\data\out</code>è·¯å¾„ä¸‹ã€‚</li>
</ol>
<p>è™½ç„¶èƒ½å¯¹32/64ä½ç¼–è¯‘æ–‡ä»¶æˆåŠŸè¿›è¡Œåç¼–è¯‘ï¼Œä¸è¿‡åç¼–è¯‘åçš„ä»£ç ä¹Ÿæ¯”è¾ƒéš¾è¯»ï¼Œç›¸æ¯”è¯»å­—èŠ‚ç å¹¶æ²¡æœ‰å‡å°‘å¤ªå¤šå·¥ä½œé‡ï¼Œä¸è¿‡ä¹Ÿä¸å¤±ä¸ºä¸€ç§ä¸é”™æ–¹æ³•ã€‚</p>
<blockquote>
<p>åæ¥å’Œç¾¤å‹è®¨è®ºï¼Œ#REtardå¸ˆå‚…è¯´ç‰ˆæœ¬ä¸ºLuaJIT-2.1.0-beta3ï¼Œå¹¶ä¸”t0hkaå¸ˆå‚…archæ‹‰çš„æœ€æ–°çš„åŒ…ï¼Œç”¨å…¶è‡ªå¸¦çš„luajit -bl å³å®Œæˆäº†åæ±‡ç¼–ã€‚</p>
</blockquote>
<p>å»å®˜ç½‘ä¸‹è½½2.1.0-beta3çš„æºç ï¼Œä½¿ç”¨VSå·¥å…·åŒ…ä¸­çš„å‘½ä»¤è¡Œç¼–è¯‘å·¥å…·<code>vcvars64.bat</code>æ¥å®Œæˆç¼–è¯‘ï¼Œåœ¨Luajitæ ¹ç›®å½•ä¸‹æ‰“å¼€cmdè¾“å…¥<code>vcvars64.bat</code></p>
<p>æ–‡ä»¶è·¯å¾„ã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"F:\visual studio2019\VC\Auxiliary\Build\vcvars64.bat"</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220528200018823.png" alt="image-20220528200018823"></p>
<blockquote>
<p>åœ¨MSVC 32ä½ç¼–è¯‘ç¯å¢ƒä¸‹  msvcbuild.bat  ç¼–è¯‘32ä½</p>
<p>msvcbuild.bat gc64ç¼–è¯‘64ä½ï¼Œç¼–è¯‘64ä½åé¢ä¸€å®šè¦è·Ÿgc64, å³ä¾¿æ˜¯å¼€å¯çš„x64çš„ç¼–è¯‘å‘½ä»¤è¡Œã€‚</p>
</blockquote>
<p>ä¹‹åæˆåŠŸç¼–è¯‘å‡º<code>luajit.exe</code> å’Œ <code>lua51.dll</code>è¿™ä¸¤ä¸ªç¨‹åºï¼Œè¿™ä¹Ÿæ˜¯luajit-decompå·¥å…·å®ç°åç¼–è¯‘çš„æ”¯æ’‘ã€‚</p>
<p>åŒç›®å½•ä¸‹ç”¨è¿‡luajit.exe -bl task.jit å¯ä»¥æ˜¾ç¤ºåç¼–è¯‘åçš„å­—èŠ‚ç ã€‚</p>
<blockquote>
<p>ç»å…¸luajit.exe -h ç½—åˆ—æŒ‡ä»¤èœå•</p>
</blockquote>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220528201038811.png" alt="image-20220528201038811"></p>
<p>åç¼–è¯‘ä¸å¾—å°±æ’¸å­—èŠ‚ç ï¼Œä¸è¿‡å®˜ç½‘ç»™å‡ºçš„ä¸»è¦æ˜¯2.0ç‰ˆæœ¬çš„bytecode ï¼Œ è¯¦ç»†å¯è§<code>src/lj_bc.h</code> ã€‚</p>
<p>å¯ä»¥è‡ªå·±å†™ä¸€äº›luaä»£ç ï¼Œä¹‹åluajit -b test.lua xxx è¿›è¡Œç¼–è¯‘ä¹‹åæŸ¥çœ‹å­—èŠ‚ç å¯¹ç…§ã€‚</p>
<blockquote>
<p>æˆ–è€…ç”¨luajit-decompåç¼–è¯‘ä¸€ä¸‹ï¼Œå¯è¯»æ€§æ˜¯æœ‰ç‚¹å·®çš„ã€‚å…ˆæš‚æ—¶å‘Šä¸€æ®µè½ï¼Œä¹‹åå¡«å‘å§ï¼Œå³ä½¿æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒå·²ç»è¢«æŒ–çš„å‘å‘æ´¼æ´¼å’¯!</p>
</blockquote>
<p><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/image-20220528213003579.png" alt="image-20220528213003579"></p>
<p>ç›¸å…³è¿æ¥:</p>
<p>LuaJitå®˜ç½‘ : <a target="_blank" rel="noopener" href="http://luajit.org/">http://luajit.org/</a>  ä¸€äº›å‚è€ƒæ–‡æ¡£å’Œç¼–è¯‘æ–¹æ³•</p>
<p><a target="_blank" rel="noopener" href="http://wiki.luajit.org/Bytecode-2.0">LuaJIT 2.0 Bytecode Instructions</a></p>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>çŸ¥è¯†é¢å’Œå¹¿åº¦è¿˜æ˜¯å·®äº†äº¿ç‚¹ï¼Œä¹‹å‰å¤ªå¤šé¢˜ç›®éƒ½åªæ˜¯å±€é™åœ¨è§£å¯†è¡¨é¢ï¼Œæ²¡å»æº¯æºã€‚åŒæ—¶å•çº¯è§£å¯†çš„è¯æ€è·¯è¦æ‰“å¼€ï¼Œèƒ½åœ¨æœ€çŸ­æ—¶é—´å†…å®šä½å…³é”®å¤„ç†å‡½æ•°çš„èƒ½åŠ›ååˆ†é‡è¦ï¼ŒåŒæ—¶èµ›åçš„å¤ç°å’Œæ·±å…¥å­¦ä¹ é¢˜ç›®æ¶‰åŠçš„è€ƒç‚¹ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„éƒ¨åˆ†ã€‚ğŸ˜ƒğŸ˜ƒğŸ˜ƒ</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Lu1u</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2022/05/28/2022DAS5%E6%9C%88/">http://example.com/2022/05/28/2022DAS5%E6%9C%88/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com" target="_blank">Lu1u</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WER/">WER</a><a class="post-meta__tags" href="/tags/CEF/">CEF</a><a class="post-meta__tags" href="/tags/LuaJIT/">LuaJIT</a></div><div class="post_share"><div class="social-share" data-image="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/xx.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/04/20/NaCl-%E7%A8%8B%E5%BA%8F%E4%BF%AE%E5%A4%8D/"><img class="next-cover" src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/wallhaven-l3ovrr.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æ¨¡æ‹Ÿæ ˆå¸§ä¿®å¤</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/lu1u.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Lu1u</div><div class="author-info__description">Never back</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">14</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">8</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/smallboyZ"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/smallboyZ" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:3194679102@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ²¿é€”é£æ™¯æ­£å¥½!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">DAS 5æœˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#wer"><span class="toc-number">1.1.</span> <span class="toc-text">wer</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E8%A7%A3"><span class="toc-number">1.1.1.</span> <span class="toc-text">æ±‚è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%AF%E6%BA%90"><span class="toc-number">1.1.2.</span> <span class="toc-text">æº¯æº</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CEF"><span class="toc-number">1.2.</span> <span class="toc-text">CEF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E8%A7%A3-2"><span class="toc-number">1.2.1.</span> <span class="toc-text">æ±‚è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%AF%E6%BA%90-2"><span class="toc-number">1.2.2.</span> <span class="toc-text">æº¯æº</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E6%8F%92%E6%9B%B2"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">å°æ’æ›²</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LuaJit"><span class="toc-number">1.3.</span> <span class="toc-text">LuaJit</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.3.1.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/28/2022DAS5%E6%9C%88/" title="DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ›"><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/xx.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ›"/></a><div class="content"><a class="title" href="/2022/05/28/2022DAS5%E6%9C%88/" title="DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ›">DAS_5æœˆ_å‡ºé¢˜äººæŒ‘æˆ˜èµ›</a><time datetime="2022-05-28T13:33:39.954Z" title="å‘è¡¨äº 2022-05-28 21:33:39">2022-05-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/20/NaCl-%E7%A8%8B%E5%BA%8F%E4%BF%AE%E5%A4%8D/" title="æ¨¡æ‹Ÿæ ˆå¸§ä¿®å¤"><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/wallhaven-l3ovrr.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ¨¡æ‹Ÿæ ˆå¸§ä¿®å¤"/></a><div class="content"><a class="title" href="/2022/04/20/NaCl-%E7%A8%8B%E5%BA%8F%E4%BF%AE%E5%A4%8D/" title="æ¨¡æ‹Ÿæ ˆå¸§ä¿®å¤">æ¨¡æ‹Ÿæ ˆå¸§ä¿®å¤</a><time datetime="2022-04-20T14:50:12.371Z" title="å‘è¡¨äº 2022-04-20 22:50:12">2022-04-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/19/StarCTF-2022/" title="\*CTF-2022-someRE"><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/123.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="\*CTF-2022-someRE"/></a><div class="content"><a class="title" href="/2022/04/19/StarCTF-2022/" title="\*CTF-2022-someRE">\*CTF-2022-someRE</a><time datetime="2022-04-19T10:00:58.141Z" title="å‘è¡¨äº 2022-04-19 18:00:58">2022-04-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/04/Android%20native%20%E9%80%86%E5%90%91/" title="Android Native Reverse(...ing)"><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/v2-cf75a3eafbb9d9862694fac62329de6c_720w.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Android Native Reverse(...ing)"/></a><div class="content"><a class="title" href="/2022/04/04/Android%20native%20%E9%80%86%E5%90%91/" title="Android Native Reverse(...ing)">Android Native Reverse(...ing)</a><time datetime="2022-04-03T17:00:04.000Z" title="å‘è¡¨äº 2022-04-04 01:00:04">2022-04-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/03/Android%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="Androidé€†å‘ç¯å¢ƒæ­å»º(æŒç»­æ›´æ–°ä¸­...)"><img src="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/andy-lg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Androidé€†å‘ç¯å¢ƒæ­å»º(æŒç»­æ›´æ–°ä¸­...)"/></a><div class="content"><a class="title" href="/2022/04/03/Android%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="Androidé€†å‘ç¯å¢ƒæ­å»º(æŒç»­æ›´æ–°ä¸­...)">Androidé€†å‘ç¯å¢ƒæ­å»º(æŒç»­æ›´æ–°ä¸­...)</a><time datetime="2022-04-03T12:10:00.000Z" title="å‘è¡¨äº 2022-04-03 20:10:00">2022-04-03</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/xx.png')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Lu1u</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">å–‚,ä¸å¯ä»¥è‰²è‰²å“¦!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç®€</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'dG9k0bNzTLa8ce8dJVPW6a1S-gzGzoHsz',
      appKey: 'uNYvcLRBa89c21aI9qAO6BBi',
      placeholder: 'æ‚„æ‚„è¯~',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: 'https://dg9k0bnz.lc-cn-n1-shared.com',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="Biu" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>