

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/QQå›¾ç‰‡20211218184601.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Lu1u">
  <meta name="keywords" content="">
  
    <meta name="description" content="2023D^3CTF RE">
<meta property="og:type" content="article">
<meta property="og:title" content="2023D^3CTF">
<meta property="og:url" content="http://example.com/2023/05/02/d3ctf-re/index.html">
<meta property="og:site_name" content="Lu1u">
<meta property="og:description" content="2023D^3CTF RE">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/main_2023.05885330.jpg">
<meta property="article:published_time" content="2023-05-02T04:21:33.415Z">
<meta property="article:modified_time" content="2023-05-02T04:24:27.346Z">
<meta property="article:author" content="Lu1u&#39;s Blog">
<meta property="article:tag" content="RE">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/main_2023.05885330.jpg">
  
  
  <title>2023D^3CTF - Lu1u</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />
  


<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->

  
<link rel="stylesheet" href="/css/mac.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0,"placement":"right"},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"follow_dnt":true},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Lightu&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                å‹é“¾
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/wallhaven-l3v7pr.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="2023D^3CTF">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-05-02 12:21" pubdate>
        2023å¹´5æœˆ2æ—¥ ä¸­åˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      12k å­—
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      99 åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2023D^3CTF</h1>
            
            <div class="markdown-body">
              <h1>D^3CTF</h1>
<p>æœ‰ä¸€æ®µæ—¶é—´æ²¡æ‘¸REäº†ï¼Œæœ€è¿‘å‡ å¤©æ‰“äº†é“ä¸‰å†³èµ›å’Œd3ctfä½œä¸ºå¤å»ºèµ›ã€‚é“ä¸‰å†³èµ›ä¸å¥½è¯„ä»·ï¼ŒCTFèµ›é¢˜è´¨é‡å ªå¿§ï¼Œå¹¶ä¸”æ•°æ®èµ›èµ›ä¸­ä¼šå‡ºæ ‡å‡†ç­”æ¡ˆ(å®¶äººä»¬xxxï¼)ï¼Œæœ€åå‡ åˆ†é’Ÿä»2æ‰åˆ°4ï¼Œç¬¬ä¸€æ¬¡ä½“éªŒåˆ°å¥–é‡‘ä¸å¤Ÿè·¯è´¹XD,èƒ½æŠ¢è¿”ç¨‹çš„è½¦ç¥¨åªèƒ½è¯´æ™ºè¡Œæ³°åº“è¾£ã€‚d3ctfä½“éªŒè¿˜æ˜¯è›®ä¸é”™çš„ï¼Œå‘Šåˆ«äº†"llvmåŠ ä¸€å †"æˆ–æ˜¯å¤§é‡å †ç§¯æŸä¸€æŠ€æœ¯çš„èµ›é¢˜ï¼Œä»åšé¢˜è§’åº¦æ„Ÿè§‰é¢˜ç›®æ¯”è¾ƒç²¾è‡´ä¼˜é›…ï¼ŒğŸ™Hellçš„ååŠæ®µå¤§æ•°è¿ç®—ä¸å¥½ç©ã€‚<br>
äº”æœˆå·²è‡³ï¼Œé€€å½¹ddlï¼Œå¸Œæœ›è¿˜èƒ½æœ‰æœºä¼šæ‰“qwbå’Œciscnã€‚</p>
<h2 id="RE-3">RE</h2>
<h3 id="d3sky">d3sky</h3>
<p>TLS_CALLBACKå‡½æ•°ä¸­å­˜åœ¨åè°ƒè¯•å’Œå¼‚å¸¸å¤„ç†ï¼Œæ­£å¸¸æ‰§è¡Œä¼šè§¦å‘é™¤0å¼‚å¸¸æ¥ä¿®æ”¹keyä¸ºYunZh1JunAlkaidã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682870462716-b7d1ac4c-3a58-4578-bd56-a6c77478c07f.png#averageHue=%23fbefee&amp;clientId=u7d00ec24-3f2a-4&amp;from=paste&amp;height=418&amp;id=u32c4db66&amp;originHeight=522&amp;originWidth=1047&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=61416&amp;status=done&amp;style=none&amp;taskId=u024830ed-5f5f-41bd-8e5f-a03ec5919b8&amp;title=&amp;width=837.6" srcset="/img/loading.gif" lazyload alt="image.png"><br>
mainå‡½æ•°ä¸»è¦é€»è¾‘æ˜¯3å­—èŠ‚è§£å¯†opcodeï¼Œä¹‹åé€šè¿‡ä¸éè¿ç®—ï¼Œé€šè¿‡ä¸éå®ç°å–åã€å–è‡ªèº«ã€å¼‚æˆ–ç­‰å…¶ä»–é€»è¾‘è¿ç®—ã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682870604939-38e8216f-2494-4269-bb58-7490e7efae73.png#averageHue=%23fcfcfa&amp;clientId=u7d00ec24-3f2a-4&amp;from=paste&amp;height=166&amp;id=u22e0a1f5&amp;originHeight=208&amp;originWidth=601&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=18751&amp;status=done&amp;style=none&amp;taskId=u24c130c9-ba49-4090-a5b5-c4f0972c90b&amp;title=&amp;width=480.8" srcset="/img/loading.gif" lazyload alt="image.png"><br>
è¾“å…¥é€å­—èŠ‚è¯»å…¥ï¼Œå¯åœ¨è®°å½•é•¿åº¦å¤„ä¸‹æ–­ä¹‹åè°ƒè¯•è§‚å¯Ÿå¯¹è¾“å…¥çš„å¤„ç†ï¼Œç¨‹åºä¸»è¦é€šè¿‡å¼‚æˆ–æ“ä½œå®ç°é€»è¾‘æ–¹ç¨‹ï¼Œæ‰€ä»¥ç›´æ¥å¯¹å­—èŠ‚ç è¿›è¡Œå¤„ç†è·å–æ–¹ç¨‹ï¼Œä¹‹åç”¨z3æ±‚è§£ï¼Œå¹¶ä¸”ç¨‹åºçº¦æŸæœ€åä¸€ä¸ªå­—ç¬¦ä¸º~ã€‚<br>
æå–æ–¹ç¨‹</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Rc4_Encrypt</span>(<span class="hljs-params">m</span>):</span><br>    out = []  <span class="hljs-comment"># putput</span><br>    i, j = <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(m)):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s[i]) % <span class="hljs-number">256</span><br><br>        s[i], s[j] = s[j], s[i]<br><br>        index = (s[i] + s[j]) % <span class="hljs-number">256</span><br>        out.append(s[index] ^ m[p])<br><br>    <span class="hljs-keyword">return</span> out<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hexdump</span>(<span class="hljs-params">m</span>):</span><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> m:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(p)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>), end=<span class="hljs-string">' '</span>)<br>    <span class="hljs-built_in">print</span>()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:<br>    key = <span class="hljs-string">'YunZh1JunAlkaid'</span><br>    s = []<br>    t = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        s.append(i)<br>        t.append(<span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)]))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s[i] + t[i]) % <span class="hljs-number">256</span><br>        s[i], s[j] = s[j], s[i]<br><br>    enc = [<span class="hljs-number">0x009E</span>, <span class="hljs-number">0x0028</span>, <span class="hljs-number">0x00F5</span>, <span class="hljs-number">0x0075</span>, <span class="hljs-number">0x0073</span>, <span class="hljs-number">0x0073</span>, <span class="hljs-number">0x0030</span>, <span class="hljs-number">0x007E</span>, <span class="hljs-number">0x0048</span>, <span class="hljs-number">0x0048</span>, <span class="hljs-number">0x00F2</span>, <span class="hljs-number">0x002F</span>, <span class="hljs-number">0x003D</span>,<br>           <span class="hljs-number">0x00EC</span>, <span class="hljs-number">0x0001</span>, <span class="hljs-number">0x0026</span>, <span class="hljs-number">0x003E</span>, <span class="hljs-number">0x00CD</span>, <span class="hljs-number">0x0082</span>, <span class="hljs-number">0x00AD</span>, <span class="hljs-number">0x00B1</span>, <span class="hljs-number">0x00D1</span>, <span class="hljs-number">0x0036</span>, <span class="hljs-number">0x00D2</span>, <span class="hljs-number">0x00B4</span>, <span class="hljs-number">0x00E5</span>,<br>           <span class="hljs-number">0x00E8</span>, <span class="hljs-number">0x004C</span>, <span class="hljs-number">0x003D</span>, <span class="hljs-number">0x000C</span>, <span class="hljs-number">0x0073</span>, <span class="hljs-number">0x00FD</span>, <span class="hljs-number">0x0059</span>, <span class="hljs-number">0x00A7</span>, <span class="hljs-number">0x0048</span>, <span class="hljs-number">0x0093</span>, <span class="hljs-number">0x00FD</span>, <span class="hljs-number">0x0006</span>, <span class="hljs-number">0x00E0</span>,<br>           <span class="hljs-number">0x0044</span>, <span class="hljs-number">0x0048</span>, <span class="hljs-number">0x0071</span>, <span class="hljs-number">0x0094</span>, <span class="hljs-number">0x004A</span>, <span class="hljs-number">0x008E</span>, <span class="hljs-number">0x00A4</span>, <span class="hljs-number">0x0036</span>, <span class="hljs-number">0x0091</span>, <span class="hljs-number">0x0023</span>, <span class="hljs-number">0x00EE</span>, <span class="hljs-number">0x0068</span>, <span class="hljs-number">0x00C1</span>,<br>           <span class="hljs-number">0x005D</span>, <span class="hljs-number">0x000B</span>, <span class="hljs-number">0x004D</span>, <span class="hljs-number">0x001A</span>, <span class="hljs-number">0x0074</span>, <span class="hljs-number">0x0083</span>, <span class="hljs-number">0x0051</span>, <span class="hljs-number">0x0052</span>, <span class="hljs-number">0x00EE</span>, <span class="hljs-number">0x00FE</span>, <span class="hljs-number">0x0011</span>, <span class="hljs-number">0x00A2</span>, <span class="hljs-number">0x00A1</span>,<br>           <span class="hljs-number">0x0064</span>, <span class="hljs-number">0x00BD</span>, <span class="hljs-number">0x0098</span>, <span class="hljs-number">0x004D</span>, <span class="hljs-number">0x00B9</span>, <span class="hljs-number">0x0097</span>, <span class="hljs-number">0x0045</span>, <span class="hljs-number">0x00E6</span>, <span class="hljs-number">0x00F7</span>]<br>    ans = Rc4_Encrypt(enc)<br>    hexdump(ans)<br>    <span class="hljs-built_in">print</span>(ans[:<span class="hljs-number">37</span>])<br>    <span class="hljs-built_in">print</span>(ans[<span class="hljs-number">37</span>:])<br>    op = [...]<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(op), <span class="hljs-number">3</span>):<br>        tmp = op[i:i + <span class="hljs-number">3</span>]<br>        res = Rc4_Encrypt(tmp)<br>        <span class="hljs-keyword">if</span> (res[<span class="hljs-number">0</span>] == res[<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> res[<span class="hljs-number">0</span>] &gt;= <span class="hljs-number">0xad4</span>) <span class="hljs-keyword">or</span> res[<span class="hljs-number">2</span>] == <span class="hljs-number">0x13</span>:<br>            hexdump(res)<br>        Rc4_Encrypt(tmp)<br><br>    <span class="hljs-string">"""</span><br><span class="hljs-string">    offset:             var</span><br><span class="hljs-string">    0xad4-0xaf8         mystr</span><br><span class="hljs-string">    0xaf9               enc</span><br><span class="hljs-string">    [0xB] = ~(~m[0]&amp;m[1])</span><br><span class="hljs-string">    [0xC] = ~(~m[1]&amp;m[0])</span><br><span class="hljs-string">    x:[0x11] = ~([0xB]&amp;[0xC])  #å¼‚æˆ–</span><br><span class="hljs-string"></span><br><span class="hljs-string">    [0xB] = ~(~m[2]&amp;m[3])</span><br><span class="hljs-string">    [0xC] = ~(~m[2]&amp;m[3])</span><br><span class="hljs-string">    y:[0x12] = ~([0xB]&amp;[0xC])  #å¼‚æˆ–</span><br><span class="hljs-string"></span><br><span class="hljs-string">    [0xB] = ~(~x&amp;y)</span><br><span class="hljs-string">    [0xC] = ~(~y&amp;x)</span><br><span class="hljs-string">    [0x12] =  ~([0xB]&amp;[0xC])</span><br><span class="hljs-string"></span><br><span class="hljs-string">    [0x13] = [0x12]^enc[0]</span><br><span class="hljs-string">    """</span><br></code></pre></td></tr></tbody></table></figure>
<p>çº¿æ€§æ±‚è§£</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br>m=[BitVec(<span class="hljs-string">"m%d"</span>%i,<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37</span>)]<br>c=[<span class="hljs-number">36</span>, <span class="hljs-number">11</span>, <span class="hljs-number">109</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">50</span>, <span class="hljs-number">66</span>, <span class="hljs-number">29</span>, <span class="hljs-number">43</span>, <span class="hljs-number">67</span>, <span class="hljs-number">120</span>, <span class="hljs-number">67</span>, <span class="hljs-number">115</span>, <span class="hljs-number">48</span>, <span class="hljs-number">43</span>, <span class="hljs-number">78</span>, <span class="hljs-number">99</span>, <span class="hljs-number">72</span>, <span class="hljs-number">119</span>, <span class="hljs-number">46</span>, <span class="hljs-number">50</span>, <span class="hljs-number">57</span>, <span class="hljs-number">26</span>, <span class="hljs-number">18</span>, <span class="hljs-number">113</span>, <span class="hljs-number">122</span>, <span class="hljs-number">66</span>, <span class="hljs-number">23</span>, <span class="hljs-number">69</span>, <span class="hljs-number">114</span>, <span class="hljs-number">86</span>, <span class="hljs-number">12</span>, <span class="hljs-number">92</span>, <span class="hljs-number">74</span>, <span class="hljs-number">98</span>, <span class="hljs-number">83</span>, <span class="hljs-number">51</span>]<br>s=Solver()<br>s.add(m[<span class="hljs-number">0</span>]^m[<span class="hljs-number">1</span>]^m[<span class="hljs-number">2</span>]^m[<span class="hljs-number">3</span>]==c[<span class="hljs-number">0</span>]         )<br>s.add(m[<span class="hljs-number">1</span>]^m[<span class="hljs-number">2</span>]^m[<span class="hljs-number">3</span>]^m[<span class="hljs-number">4</span>]==c[<span class="hljs-number">1</span>]         )<br>s.add(m[<span class="hljs-number">2</span>]^m[<span class="hljs-number">3</span>]^m[<span class="hljs-number">4</span>]^m[<span class="hljs-number">5</span>]==c[<span class="hljs-number">2</span>]         )<br>s.add(m[<span class="hljs-number">3</span>]^m[<span class="hljs-number">4</span>]^m[<span class="hljs-number">5</span>]^m[<span class="hljs-number">6</span>]==c[<span class="hljs-number">3</span>]         )<br>s.add(m[<span class="hljs-number">4</span>]^m[<span class="hljs-number">5</span>]^m[<span class="hljs-number">6</span>]^m[<span class="hljs-number">7</span>]==c[<span class="hljs-number">4</span>]         )<br>s.add(m[<span class="hljs-number">5</span>]^m[<span class="hljs-number">6</span>]^m[<span class="hljs-number">7</span>]^m[<span class="hljs-number">8</span>]==c[<span class="hljs-number">5</span>]         )<br>s.add(m[<span class="hljs-number">6</span>]^m[<span class="hljs-number">7</span>]^m[<span class="hljs-number">8</span>]^m[<span class="hljs-number">9</span>]==c[<span class="hljs-number">6</span>]         )<br>s.add(m[<span class="hljs-number">7</span>]^m[<span class="hljs-number">8</span>]^m[<span class="hljs-number">9</span>]^m[<span class="hljs-number">10</span>]==c[<span class="hljs-number">7</span>]        )<br>s.add(m[<span class="hljs-number">8</span>]^m[<span class="hljs-number">9</span>]^m[<span class="hljs-number">10</span>]^m[<span class="hljs-number">11</span>]==c[<span class="hljs-number">8</span>]       )<br>s.add(m[<span class="hljs-number">9</span>]^m[<span class="hljs-number">10</span>]^m[<span class="hljs-number">11</span>]^m[<span class="hljs-number">12</span>]==c[<span class="hljs-number">9</span>]      )<br>s.add(m[<span class="hljs-number">10</span>]^m[<span class="hljs-number">11</span>]^m[<span class="hljs-number">12</span>]^m[<span class="hljs-number">13</span>]==c[<span class="hljs-number">10</span>]    )<br>s.add(m[<span class="hljs-number">11</span>]^m[<span class="hljs-number">12</span>]^m[<span class="hljs-number">13</span>]^m[<span class="hljs-number">14</span>]==c[<span class="hljs-number">11</span>]    )<br>s.add(m[<span class="hljs-number">12</span>]^m[<span class="hljs-number">13</span>]^m[<span class="hljs-number">14</span>]^m[<span class="hljs-number">15</span>]==c[<span class="hljs-number">12</span>]    )<br>s.add(m[<span class="hljs-number">13</span>]^m[<span class="hljs-number">14</span>]^m[<span class="hljs-number">15</span>]^m[<span class="hljs-number">16</span>]==c[<span class="hljs-number">13</span>]    )<br>s.add(m[<span class="hljs-number">14</span>]^m[<span class="hljs-number">15</span>]^m[<span class="hljs-number">16</span>]^m[<span class="hljs-number">17</span>]==c[<span class="hljs-number">14</span>]    )<br>s.add(m[<span class="hljs-number">15</span>]^m[<span class="hljs-number">16</span>]^m[<span class="hljs-number">17</span>]^m[<span class="hljs-number">18</span>]==c[<span class="hljs-number">15</span>]    )<br>s.add(m[<span class="hljs-number">16</span>]^m[<span class="hljs-number">17</span>]^m[<span class="hljs-number">18</span>]^m[<span class="hljs-number">19</span>]==c[<span class="hljs-number">16</span>]    )<br>s.add(m[<span class="hljs-number">17</span>]^m[<span class="hljs-number">18</span>]^m[<span class="hljs-number">19</span>]^m[<span class="hljs-number">20</span>]==c[<span class="hljs-number">17</span>]    )<br>s.add(m[<span class="hljs-number">18</span>]^m[<span class="hljs-number">19</span>]^m[<span class="hljs-number">20</span>]^m[<span class="hljs-number">21</span>]==c[<span class="hljs-number">18</span>]    )<br>s.add(m[<span class="hljs-number">19</span>]^m[<span class="hljs-number">20</span>]^m[<span class="hljs-number">21</span>]^m[<span class="hljs-number">22</span>]==c[<span class="hljs-number">19</span>]    )<br>s.add(m[<span class="hljs-number">20</span>]^m[<span class="hljs-number">21</span>]^m[<span class="hljs-number">22</span>]^m[<span class="hljs-number">23</span>]==c[<span class="hljs-number">20</span>]    )<br>s.add(m[<span class="hljs-number">21</span>]^m[<span class="hljs-number">22</span>]^m[<span class="hljs-number">23</span>]^m[<span class="hljs-number">24</span>]==c[<span class="hljs-number">21</span>]    )<br>s.add(m[<span class="hljs-number">22</span>]^m[<span class="hljs-number">23</span>]^m[<span class="hljs-number">24</span>]^m[<span class="hljs-number">25</span>]==c[<span class="hljs-number">22</span>]    )<br>s.add(m[<span class="hljs-number">23</span>]^m[<span class="hljs-number">24</span>]^m[<span class="hljs-number">25</span>]^m[<span class="hljs-number">26</span>]==c[<span class="hljs-number">23</span>]    )<br>s.add(m[<span class="hljs-number">24</span>]^m[<span class="hljs-number">25</span>]^m[<span class="hljs-number">26</span>]^m[<span class="hljs-number">27</span>]==c[<span class="hljs-number">24</span>]    )<br>s.add(m[<span class="hljs-number">25</span>]^m[<span class="hljs-number">26</span>]^m[<span class="hljs-number">27</span>]^m[<span class="hljs-number">28</span>]==c[<span class="hljs-number">25</span>]    )<br>s.add(m[<span class="hljs-number">26</span>]^m[<span class="hljs-number">27</span>]^m[<span class="hljs-number">28</span>]^m[<span class="hljs-number">29</span>]==c[<span class="hljs-number">26</span>]    )<br>s.add(m[<span class="hljs-number">27</span>]^m[<span class="hljs-number">28</span>]^m[<span class="hljs-number">29</span>]^m[<span class="hljs-number">30</span>]==c[<span class="hljs-number">27</span>]    )<br>s.add(m[<span class="hljs-number">28</span>]^m[<span class="hljs-number">29</span>]^m[<span class="hljs-number">30</span>]^m[<span class="hljs-number">31</span>]==c[<span class="hljs-number">28</span>]    )<br>s.add(m[<span class="hljs-number">29</span>]^m[<span class="hljs-number">30</span>]^m[<span class="hljs-number">31</span>]^m[<span class="hljs-number">32</span>]==c[<span class="hljs-number">29</span>]    )<br>s.add(m[<span class="hljs-number">30</span>]^m[<span class="hljs-number">31</span>]^m[<span class="hljs-number">32</span>]^m[<span class="hljs-number">33</span>]==c[<span class="hljs-number">30</span>]    )<br>s.add(m[<span class="hljs-number">31</span>]^m[<span class="hljs-number">32</span>]^m[<span class="hljs-number">33</span>]^m[<span class="hljs-number">34</span>]==c[<span class="hljs-number">31</span>]    )<br>s.add(m[<span class="hljs-number">32</span>]^m[<span class="hljs-number">33</span>]^m[<span class="hljs-number">34</span>]^m[<span class="hljs-number">35</span>]==c[<span class="hljs-number">32</span>]    )<br>s.add(m[<span class="hljs-number">33</span>]^m[<span class="hljs-number">34</span>]^m[<span class="hljs-number">35</span>]^m[<span class="hljs-number">36</span>]==c[<span class="hljs-number">33</span>]    )<br>s.add(m[<span class="hljs-number">34</span>]^m[<span class="hljs-number">35</span>]^m[<span class="hljs-number">36</span>]^m[<span class="hljs-number">0</span>]==c[<span class="hljs-number">34</span>]     )<br>s.add(m[<span class="hljs-number">35</span>]^m[<span class="hljs-number">36</span>]^m[<span class="hljs-number">0</span>]^m[<span class="hljs-number">1</span>]==c[<span class="hljs-number">35</span>]      )<br>s.add(m[<span class="hljs-number">36</span>]^m[<span class="hljs-number">0</span>]^m[<span class="hljs-number">1</span>]^m[<span class="hljs-number">2</span>]==c[<span class="hljs-number">36</span>]       )<br>s.add(m[<span class="hljs-number">36</span>]==<span class="hljs-number">0x7e</span>)<br><span class="hljs-keyword">if</span> s.check() ==z3.sat:<br>    res=s.model()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">37</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(res[m[i]].as_long()),end=<span class="hljs-string">''</span>)<br><span class="hljs-built_in">print</span>()<br></code></pre></td></tr></tbody></table></figure>
<h3 id="d3recover">d3recover</h3>
<p>ver2ç‰ˆæœ¬çš„pydæ²¡æœ‰å»ç¬¦å·ï¼Œå¹¶ä¸”base64å¯†æ–‡å¯ç›´æ¥è§£å¯†ï¼Œæ¨æµ‹æ²¡æœ‰æ¢è¡¨ï¼Œä¹‹åç”¨bindiffæ¢å¤ver1çš„ç¬¦å·ã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682871273793-84764da9-9ad9-4a74-b86c-9d0b715e714c.png#averageHue=%23fcfbfa&amp;clientId=u7d00ec24-3f2a-4&amp;from=paste&amp;height=75&amp;id=ub1172a1b&amp;originHeight=94&amp;originWidth=1046&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=12577&amp;status=done&amp;style=none&amp;taskId=ub409e8b5-677f-426e-ad0e-97d72c86583&amp;title=&amp;width=836.8" srcset="/img/loading.gif" lazyload alt="image.png"><br>
æ‰¾åˆ°å¯ä»¥çš„checkå‡½æ•°,æ•´ç†ä¸»è¦é€»è¾‘å¦‚ä¸‹</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0LL</span>; i &lt;= <span class="hljs-number">31</span>; ++i ){<br>    Item = (_QWORD *)_Pyx_PyInt_From_long(i);<br>    Item = (_QWORD *)_Pyx_PyObject_GetItem(a2, Item);<br>    _Pyx_PyByteArray_Append(v9, v24 ^ <span class="hljs-number">0x23</span>u);<br>}<br><span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0LL</span>; j &lt;= <span class="hljs-number">29</span>; ++j ){<br> 	   Item = (_QWORD *)_Pyx_PyInt_From_long(j);<br>     v16 = (_QWORD *)_Pyx_PyInt_AddObjC(v10, qword_ABC1E8, <span class="hljs-number">2LL</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>);<br>     v17 = (_QWORD *)_Pyx_PyObject_GetItem(v9, v16);<br>     v16 = (_QWORD *)PyNumber_Add(Item, v17);<br>     v17 = (_QWORD *)_Pyx_PyInt_AndObjC(v16, qword_ABC220, <span class="hljs-number">255LL</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>);<br>     v16 = (_QWORD *)_Pyx_PyInt_XorObjC((__int64)v17, qword_ABC218, <span class="hljs-number">0x54</span>LL, <span class="hljs-number">0</span>);<br>     PyObject_SetItem(v9, v10, v16) <br>}<br></code></pre></td></tr></tbody></table></figure>
<p>å¯¹å¯ç–‘base64ä¸²è§£å¯†ï¼Œå¹¶å¯¹ä¸Šè¿°æ“ä½œæ±‚é€†å³å¯getflagã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">import</span> base64<br>s=<span class="hljs-string">'08fOyj+E27O2uYDq0M1y/Ngwldvi2JIIwcbF9AfsAl4='</span><br>s=base64.b64decode(s)<br><span class="hljs-string">""</span><span class="hljs-string">"</span><br><span class="hljs-string">for i in range(32):</span><br><span class="hljs-string">    s[i]^=0x23</span><br><span class="hljs-string">for j in range(30):</span><br><span class="hljs-string">    s[i]+=s[i+2]</span><br><span class="hljs-string">    s[i]&amp;=0x255</span><br><span class="hljs-string">    s[i]^=0x54</span><br><span class="hljs-string">"</span><span class="hljs-string">""</span><br>s=<span class="hljs-built_in">list</span>(s)<br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">29</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">-1</span>):<br>    s[i]^=<span class="hljs-number">0x54</span><br>    s[i]=(s[i]-s[i+<span class="hljs-number">2</span>]+<span class="hljs-number">0x100</span>)&amp;<span class="hljs-number">0xff</span><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">32</span>):<br>    s[i]^=<span class="hljs-number">0x23</span><br>print(bytes(s))<br><br></code></pre></td></tr></tbody></table></figure>
<h3 id="d3rc4">d3rc4</h3>
<p>init_arrayå’Œfini_arrayä¸­éƒ½æ·»åŠ äº†å¤„ç†å‡½æ•°ï¼Œå‰è€…è´Ÿè´£è§£å¯†ç§˜é’¥å’Œç›¸å…³æ•°æ®ï¼Œåè€…ä¸ºçœŸæ­£çš„flagchecké€»è¾‘ã€‚mainå‡½æ•°ä¸­ä¸ºå‡é€»è¾‘ï¼Œåˆ›å»ºäº†å…¨å±€ç®¡é“ï¼Œå¹¶ä¸”å¯¹è¾“å…¥è¿›è¡Œäº†rc4åŠ å¯†ï¼Œsboxä¸ºå…¨å±€å˜é‡ã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682871798206-3eb3f687-830b-4f75-bc30-aca3b72391b2.png#averageHue=%23fdfdfc&amp;clientId=u7d00ec24-3f2a-4&amp;from=paste&amp;height=285&amp;id=ubc21fd58&amp;originHeight=356&amp;originWidth=466&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=20290&amp;status=done&amp;style=none&amp;taskId=u0a11e75e-1971-4d96-88c3-7e9bfb92b15&amp;title=&amp;width=372.8" srcset="/img/loading.gif" lazyload alt="image.png"><br>
åœ¨fini_arrayæ³¨å†Œçš„å‡½æ•°ä¸­ï¼Œçˆ¶ç¨‹åºforkå‡ºè‡ªç¨‹åºå¹¶é€šè¿‡ç®¡é“è¿›è¡Œé€šä¿¡æ¥å¯¹è¾“å…¥è¿›ä¸€æ­¥åŠ å¯†ï¼Œè€ƒè™‘åˆ°ç†æ¸…è¿›ç¨‹é€šä¿¡éå¸¸çš„è€—æ—¶å’Œå¤æ‚ï¼Œæ‰€ä»¥é€šè¿‡patchç¨‹åºæ¥è¿›è¡Œæ±‚è§£ã€‚å¯çŸ¥å¯¹è¾“å…¥çš„åŠ å¯†ç¦»ä¸å¼€ç§˜é’¥æµkeystreamï¼Œå¹¶ä¸”ç§˜é’¥æµç”±å•ç‹¬çš„å‡½æ•°ç”Ÿæˆï¼Œè€Œåœ¨å¯¹è¾“å…¥çš„åŠ å¯†ä¸­ä¸ä¼šè¢«å¹²æ‰°ï¼Œæ‰€ä»¥å¯¹è¾“å…¥åŠ å¯†çš„éƒ¨åˆ†å¯ä»¥éšä¾¿patchã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682871869968-83e0134d-d458-4fd1-b019-88a11c1c75fc.png#averageHue=%23fdfdfd&amp;clientId=u7d00ec24-3f2a-4&amp;from=paste&amp;height=393&amp;id=u577a54b0&amp;originHeight=491&amp;originWidth=736&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=32941&amp;status=done&amp;style=none&amp;taskId=u234377a8-dee1-4c62-a578-2e1a0b00d72&amp;title=&amp;width=588.8" srcset="/img/loading.gif" lazyload alt="image.png"><br>
ç¨‹åºä¸­å­˜åœ¨writeå‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥å°†åŠ å¯†çš„éƒ¨åˆ†patchä¸ºwrite(1,keystream,len);å³å¯å°†ç§˜é’¥æµè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œä¹‹ååªéœ€å°†æ¯æ¬¡çš„ç§˜é’¥æµå€’å™è§£å¯†å¯†æ–‡ï¼Œä¹‹åå†rc4è§£å¯†å³å¯getflagã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c">write = <span class="hljs-number">0x1040</span><br><span class="hljs-string">""</span><span class="hljs-string">"_write(stdout,keystream,len)</span><br><span class="hljs-string">.text:0000000000001956                 mov     edx, slen</span><br><span class="hljs-string">.text:000000000000195D                 lea     rsi, keystream  ; buf</span><br><span class="hljs-string">.text:0000000000001964                 mov     rdi, 1          ; fd</span><br><span class="hljs-string">.text:000000000000196B                 mov     eax, 0</span><br><span class="hljs-string">.text:0000000000001970                 call    _write                      </span><br><span class="hljs-string">"</span><span class="hljs-string">""</span><br>f=open(r<span class="hljs-number">'</span>dumpkeystream<span class="hljs-number">'</span>,<span class="hljs-string">'rb'</span>) # æ‰§è¡Œ ./d3rc4 &gt; dumpkeystream<br>buf=f.read()<br>f.close()<br>all_xor=[]<br>print(<span class="hljs-string">"len mod 36:"</span>,len(buf)%<span class="hljs-number">36</span>)<br><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,len(buf),<span class="hljs-number">36</span>):<br>    t=buf[i:i+<span class="hljs-number">36</span>]<br>    all_xor.append(t)<br><br>all_xor=all_xor[::<span class="hljs-number">-1</span>]<br><br>c=[<span class="hljs-number">0xF7</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x1F</span>]<br>c=<span class="hljs-built_in">list</span>(c)<br>t=[<span class="hljs-number">0xDA</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x3F</span>]<br><span class="hljs-keyword">for</span> ks in all_xor[:<span class="hljs-number">1</span>]:   #è°ƒè¯•å¾—çŸ¥ä½¿ç”¨ä¸€ç»„ç§˜é’¥æµå³å¯<br>    <span class="hljs-keyword">for</span> j in range(<span class="hljs-number">0</span>,len(c),<span class="hljs-number">2</span>):<br>        c[j+<span class="hljs-number">1</span>]=ks[j+<span class="hljs-number">1</span>]^c[j+<span class="hljs-number">1</span>]<br>        c[j+<span class="hljs-number">1</span>]=(c[j]-c[j+<span class="hljs-number">1</span>]+<span class="hljs-number">0x100</span>)&amp;<span class="hljs-number">0xff</span><br>        c[j]^=ks[j]<br>        c[j]=(c[j]-c[j+<span class="hljs-number">1</span>]+<span class="hljs-number">0x100</span>)&amp;<span class="hljs-number">0xff</span><br>        <span class="hljs-keyword">if</span> c==t:<br>            print(c)<br>            print(all_xor.index(ks))<br><br>print(bytes(c).hex())<br></code></pre></td></tr></tbody></table></figure>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682906451359-fc383003-9ff9-43c1-a6ab-7008699f1c19.png#averageHue=%23fcfcfb&amp;clientId=u0bc68483-e803-4&amp;from=paste&amp;height=474&amp;id=ud92dd7f2&amp;originHeight=593&amp;originWidth=1314&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=28951&amp;status=done&amp;style=none&amp;taskId=uca0d7402-5193-4c41-b640-3a60dfcbaed&amp;title=&amp;width=1051.2" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<h3 id="d3syscall">d3syscall</h3>
<p>æ³¨å†Œäº†initå‡½æ•°ï¼Œè§£å¯†å‡ºelfæ–‡ä»¶å¹¶é‡Šæ”¾åˆ°/tmp/my_module,ä¹‹åé€šè¿‡è¯»/proc/kallsymsè·å–sys_call_tableï¼Œå¹¶é€šè¿‡syscall 313æ³¨å†Œè¯¥æ¨¡å—å‡ºï¼Œä¼ å…¥sys_call_tableçš„åœ°å€ã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682872403958-8be3f595-5c6d-4062-a8df-56dabbb92581.png#averageHue=%23fdfdfd&amp;clientId=u7d00ec24-3f2a-4&amp;from=paste&amp;height=421&amp;id=u5740a135&amp;originHeight=526&amp;originWidth=752&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=44297&amp;status=done&amp;style=none&amp;taskId=udc750bb5-5013-40c5-9960-c21e1a45c55&amp;title=&amp;width=601.6" srcset="/img/loading.gif" lazyload alt="image.png"><br>
mainå‡½æ•°é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ†ç»„å¯¹è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œä¸€ç»„å¤„ç†16å­—èŠ‚ï¼Œè€Œåœ¨æ³¨å†Œçš„moduleä¸­å¯¹ç³»ç»Ÿè°ƒç”¨è¿›è¡Œäº†hookå®ç°äº†ä¸€ä¸ªå°å‹çš„vmã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682872662222-1d3d83d8-1192-46da-be86-2caa4c18e56a.png#averageHue=%23fdfdfc&amp;clientId=u7d00ec24-3f2a-4&amp;from=paste&amp;height=403&amp;id=uec10693d&amp;originHeight=504&amp;originWidth=645&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=48253&amp;status=done&amp;style=none&amp;taskId=u52ae0689-630d-4eb8-a765-328786831b0&amp;title=&amp;width=516" srcset="/img/loading.gif" lazyload alt="image.png"><br>
ä¸Šè¿°å‘½åå¹¶ä¸å‡†ç¡®ï¼Œå¯è§å…¶hookäº†ç¨‹åºä¸­ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå¹¶ä¸”æ¨¡æ‹Ÿäº†æ ˆï¼Œä½¿ç”¨äº†å¯„å­˜å™¨ï¼Œå¹¶ä¸”0x150ä¸­å®ç°äº†å·¦ç§»ã€å¼‚æˆ–ã€åŠ å‡ä¹˜ç­‰è¿ç®—ï¼Œåç»­é€†å‘åªéœ€è§£æç³»ç»Ÿè°ƒç”¨ï¼Œåˆ†æå…¶é€»è¾‘å³å¯ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-string">"""</span><br><span class="hljs-string">reg[0]=m[0]</span><br><span class="hljs-string">reg[1]=m[1]</span><br><span class="hljs-string">data[1]=reg[1]</span><br><span class="hljs-string">reg[2]=reg[0]</span><br><span class="hljs-string">reg[1]=3</span><br><span class="hljs-string">reg[2]&lt;&lt;=reg[1]</span><br><span class="hljs-string">reg[1]=0x51E7647E</span><br><span class="hljs-string">reg[2]+=reg[1]</span><br><span class="hljs-string">reg[3]=reg[0]</span><br><span class="hljs-string">reg[1]=3</span><br><span class="hljs-string">reg[3]*=reg[1]</span><br><span class="hljs-string">reg[1]=0x0E0B4140A</span><br><span class="hljs-string">reg[3]+=reg[1]</span><br><span class="hljs-string">reg[2]^=reg[3]</span><br><span class="hljs-string">reg[3]=reg[0]</span><br><span class="hljs-string">reg[1]=0x0E6978F27</span><br><span class="hljs-string">reg[3]+=reg[1]</span><br><span class="hljs-string">reg[2]^=reg[3]</span><br><span class="hljs-string"></span><br><span class="hljs-string">reg[1]=data[1]</span><br><span class="hljs-string">reg[1]+=reg[2]</span><br><span class="hljs-string">data[1]=reg[1]</span><br><span class="hljs-string">data[2]=reg[0]</span><br><span class="hljs-string"></span><br><span class="hljs-string">reg[2]=reg[1]</span><br><span class="hljs-string">reg[0]=6</span><br><span class="hljs-string">reg[2]&lt;&lt;=reg[0]</span><br><span class="hljs-string">reg[0]=0x53A35337</span><br><span class="hljs-string">reg[2]+=reg[0]</span><br><span class="hljs-string">reg[3]=reg[1]</span><br><span class="hljs-string">reg[0]=5</span><br><span class="hljs-string">reg[3]*=reg[0]</span><br><span class="hljs-string">reg[0]=0x9840294D</span><br><span class="hljs-string">reg[3]+=reg[0]</span><br><span class="hljs-string">reg[2]^=reg[3]</span><br><span class="hljs-string">reg[3]=reg[1]</span><br><span class="hljs-string">reg[0]=0x5EAE4751</span><br><span class="hljs-string">reg[3]-=reg[0]</span><br><span class="hljs-string">reg[2]^=reg[3]</span><br><span class="hljs-string">reg[0]=data[2]</span><br><span class="hljs-string">reg[0]+=reg[2]</span><br><span class="hljs-string">data[2]=reg[0]</span><br><span class="hljs-string"></span><br><span class="hljs-string">d1=m1+((m0&lt;&lt;3)+0x51E7647E)^(3*m0+0x0E0B4140A)^(m0+0x0E6978F27)</span><br><span class="hljs-string">d2=v0+((d1&lt;&lt;6)+0x53A35337)^(5*d1+0x9840294D)^(d1-0x5EAE4751)</span><br><span class="hljs-string">"""</span><br><br>code=<span class="hljs-string">"""</span><br><span class="hljs-string">v0=v1+(((v0&lt;&lt;3)+0x51E7647E)^(3*v0+0x0E0B4140A)^(v0+0x0E6978F27))</span><br><span class="hljs-string">data[2]=v0+(((v1&lt;&lt;6)+0x53A35337)^(5*v1+0x9840294D)^(v1-0x5EAE4751))</span><br><span class="hljs-string">"""</span><br>v4=[<span class="hljs-number">0</span>]*<span class="hljs-number">6</span><br>v4[<span class="hljs-number">0</span>] = <span class="hljs-number">0xB0800699CB89CC89</span><br>v4[<span class="hljs-number">1</span>] =  <span class="hljs-number">0x4764FD523FA00B19</span><br>v4[<span class="hljs-number">2</span>] = <span class="hljs-number">0x396A7E6DF099D700</span><br>v4[<span class="hljs-number">3</span>] =  <span class="hljs-number">0xB115D56BCDEAF50A</span><br>v4[<span class="hljs-number">4</span>] =  <span class="hljs-number">0x2521513C985791F4</span><br>v4[<span class="hljs-number">5</span>] = <span class="hljs-number">0xB03C06AF93AD0BE</span><br><br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">2</span>):<br>    m0=BitVec(<span class="hljs-string">'m0'</span>,<span class="hljs-number">64</span>)<br>    m1=BitVec(<span class="hljs-string">'m1'</span>,<span class="hljs-number">64</span>)<br>    d1=m1+(((m0&lt;&lt;<span class="hljs-number">3</span>)+<span class="hljs-number">0x51E7647E</span>)^(<span class="hljs-number">3</span>*m0+<span class="hljs-number">0x0E0B4140A</span>)^(m0+<span class="hljs-number">0x0E6978F27</span>))<br>    d2=m0+(((d1&lt;&lt;<span class="hljs-number">6</span>)+<span class="hljs-number">0x53A35337</span>)^(<span class="hljs-number">5</span>*d1+<span class="hljs-number">0x9840294D</span>)^(d1-<span class="hljs-number">0x5EAE4751</span>))<br>    s=Solver()<br>    s.add(d1&amp;<span class="hljs-number">0xffffffffffffffff</span>==v4[i])<br>    s.add(d2&amp;<span class="hljs-number">0xffffffffffffffff</span>==v4[i+<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> s.check()==z3.sat:<br>        m=s.model()<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>.to_bytes(m[m0].as_long(),<span class="hljs-number">8</span>,<span class="hljs-string">'little'</span>).decode(),end=<span class="hljs-string">''</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>.to_bytes(m[m1].as_long(),<span class="hljs-number">8</span>,<span class="hljs-string">'little'</span>).decode(),end=<span class="hljs-string">''</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">'nnd'</span>)<br></code></pre></td></tr></tbody></table></figure>
<h3 id="d3Hell">d3Hell</h3>
<p>64call32å®ç°smcè§£å¯†ï¼Œåç»­åˆ™å­˜åœ¨åè°ƒè¯•å’Œcheck patchæ¥æ§åˆ¶å‚æ•°çš„ç”Ÿæˆã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">"""  Hell + SMC</span><br><span class="hljs-string">.text:666C164F                 nop</span><br><span class="hljs-string">.text:666C1650                 mov     dword ptr [ebp-0Ch], offset unk_666C169A</span><br><span class="hljs-string">.text:666C1657                 mov     dword ptr [ebp-8], 0</span><br><span class="hljs-string">.text:666C165E                 mov     dword ptr [ebp-8], 1</span><br><span class="hljs-string">.text:666C1665                 jmp     short loc_666C1690</span><br><span class="hljs-string">.text:666C1667 ; ---------------------------------------------------------------------------</span><br><span class="hljs-string">.text:666C1667</span><br><span class="hljs-string">.text:666C1667 loc_666C1667:                           ; CODE XREF: .text:666C1697â†“j</span><br><span class="hljs-string">.text:666C1667                 mov     edx, [ebp-8]</span><br><span class="hljs-string">.text:666C166A                 mov     eax, [ebp-0Ch]</span><br><span class="hljs-string">.text:666C166D                 add     edx, eax            </span><br><span class="hljs-string">.text:666C166F                 mov     ecx, [ebp-8]</span><br><span class="hljs-string">.text:666C1672                 mov     eax, [ebp-0Ch]</span><br><span class="hljs-string">.text:666C1675                 add     eax, ecx</span><br><span class="hljs-string">.text:666C1677                 movzx   ecx, byte ptr [eax]   //code[i]</span><br><span class="hljs-string">.text:666C167A                 mov     eax, [ebp-8]</span><br><span class="hljs-string">.text:666C167D                 lea     ebx, [eax-1]</span><br><span class="hljs-string">.text:666C1680                 mov     eax, [ebp-0Ch]</span><br><span class="hljs-string">.text:666C1683                 add     eax, ebx</span><br><span class="hljs-string">.text:666C1685                 movzx   eax, byte ptr [eax]  //code[i-1]</span><br><span class="hljs-string">.text:666C1688                 xor     eax, ecx</span><br><span class="hljs-string">.text:666C168A                 mov     [edx], al</span><br><span class="hljs-string">.text:666C168C                 add     dword ptr [ebp-8], 1</span><br><span class="hljs-string">.text:666C1690</span><br><span class="hljs-string">.text:666C1690 loc_666C1690:                           ; CODE XREF: .text:666C1665â†‘j</span><br><span class="hljs-string">.text:666C1690                 cmp     dword ptr [ebp-8], 249h  </span><br><span class="hljs-string">.text:666C1697                 jle     short loc_666C1667</span><br><span class="hljs-string">"""</span><br><br><span class="hljs-keyword">import</span> ida_bytes<br>c=[...] <span class="hljs-comment">#op</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(c)):<br>    c[i]^=c[i-<span class="hljs-number">1</span>]<br>adr=<span class="hljs-number">0x666C169A</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    patch_byte(adr+i,c[i])<br><span class="hljs-built_in">print</span>(<span class="hljs-string">'ok'</span>)<br></code></pre></td></tr></tbody></table></figure>
<p>å¯¹dllæ‰“patchå³å¯ï¼Œè¿‡æ‰åè°ƒå’Œcheck patchï¼Œç»“æœå¦‚ä¸‹ã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682873093745-491918f6-f013-4ccc-8795-dc79c61a0fd7.png#averageHue=%23fdfdfc&amp;clientId=u7d00ec24-3f2a-4&amp;from=paste&amp;height=387&amp;id=u716c4018&amp;originHeight=484&amp;originWidth=724&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=41029&amp;status=done&amp;style=none&amp;taskId=u7bf0f6f3-8fac-4e55-80b4-61b89d0e9be&amp;title=&amp;width=579.2" srcset="/img/loading.gif" lazyload alt="image.png"><br>
è°ƒè¯•å³å¯è·å–è§£å¯†çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¼šæ›´æ–°d3.exeç¨‹åºä¸­çš„å˜é‡ï¼Œæ­£ç¡®å€¼ä¸º0x86928e90099b26cedf3f1f2af783e1ã€‚åœ¨d3.exeä¸­é€šè¿‡sleepå’Œä¸€äº›è¿”å›æ’å€¼çš„é€’å½’å‡½æ•°æ¥è€—æ—¶ï¼Œä½†å½±å“å¹¶ä¸ç®—å¤§ï¼Œæœ€è€—æ—¶çš„åœ¨sub_401E64åŠå…¶ä¸Šå±‚å‡½æ•°ï¼Œè°ƒè¯•å¯çŸ¥å…¶é€šè¿‡ (x*x +120) mod mç”Ÿæˆæ•°æ®dï¼Œå¹¶é€šè¿‡gcd(d,m)æ¥åˆ†è§£mä¸ºç´ å› æ•°ã€‚</p>
<blockquote>
<p>sub_401799æ˜¯gcd ï¼Œ sub_4040C0æ˜¯modç­‰ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">v0=<span class="hljs-number">1</span><br>v1=<span class="hljs-number">2</span><br>x=<span class="hljs-number">0x72AE</span><br>x=x+<span class="hljs-number">1</span><br>m=<span class="hljs-number">0x86928e90099b26cedf3f1f2af783e1</span><br>t=x<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    v0+=<span class="hljs-number">1</span><br>    dd=(m+x-(x*x+<span class="hljs-number">120</span>))%m<br>    <span class="hljs-keyword">if</span> gp.gcd(dd,m)!=<span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"get"</span>)<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-comment">#print(hex(dd))</span><br>    x=(x*x+<span class="hljs-number">120</span>)%m<br>    <span class="hljs-comment"># print(hex(x), hex(t))</span><br>    <span class="hljs-keyword">if</span> t==x :<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> v0==v1:<br>        t=x<br>        v1*=<span class="hljs-number">2</span><br><span class="hljs-built_in">print</span>(x)<br></code></pre></td></tr></tbody></table></figure>
<p>æ‰€ä»¥ç›´æ¥åˆ†è§£698740305822331500978964939673142241ï¼Œå¾—åˆ°ä¸¤ä¸ªç´ å› å­ï¼Œåç»­ä¸ºå°†ä¸¤ä¸ªç´ å› å­çš„å€¼æ‹¼èµ·æ¥å³ä¸ºflagã€‚</p>
<h3 id="d3Tetris">d3Tetris</h3>
<p>Androidæ¸¸æˆé¢˜ï¼Œä¸»è¦é€»è¾‘åœ¨GameViewModelç±»ï¼Œé€šè¿‡é‡è½½çš„toStringå‡½æ•°å¯çŸ¥ç›¸å…³å˜é‡å¯¹åº”çš„å…·ä½“å†…å®¹ã€‚æ ¹æ®é¢˜ç›®æä¾›çš„é™„ä»¶ä¸­æµé‡åŒ…ï¼Œå¯çŸ¥å‘192.168.43.57:1234å‘é€äº†æµé‡åŒ…ï¼Œæœç´¢ipå®šä½å…³é”®ä»£ç ã€‚<br>
<img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682998355475-4ef23684-be51-4079-a2e5-bba8f3e06a9b.png#averageHue=%23fcf9f8&amp;clientId=u98a88316-5810-4&amp;from=paste&amp;height=169&amp;id=ud2112767&amp;originHeight=211&amp;originWidth=1380&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=22920&amp;status=done&amp;style=none&amp;taskId=u90ca365b-f47b-46c0-8332-55b50561087&amp;title=&amp;width=1104" srcset="/img/loading.gif" lazyload alt="image.png"><br>
å…¶è¦æ±‚åˆ†æ•°è¾¾åˆ°ä¸€å®šå€¼æ‰ä¼šå‘åŒ…ï¼Œæ‰€ä»¥ä¿®æ”¹smailä»£ç è®©å…¶ä¸€ç›´å‘åŒ…ï¼Œå¹¶ä¸”åŒ…çš„å†…å®¹ä¸oO0OooOo0oO()å’ŒooooOOOOO00000()å‡½æ•°ç›¸å…³,ä¸ºlibnativeå¯¼å‡ºçš„å‡½æ•°,å¹¶å°†ä¸¤è€…çš„å†…å®¹æ‹¼æ¥ã€‚</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">System.loadLibrary(<span class="hljs-string">"native"</span>)<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> native byte[] oO0OooOo0oO();<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> native byte[] ooooOOOOO00000();<br></code></pre></td></tr></tbody></table></figure>
<p>ä¸¤ä¸ªå‡½æ•°å‡ä¸éœ€è¦å‚æ•°æ‰€ä»¥å­—ç¬¦ä¸²ä¸ºå†…éƒ¨ç”Ÿæˆï¼Œå°è¯•è°ƒè¯•ï¼Œä¸ªäººè°ƒè¯•è¿‡ç¨‹ä¸­åœ¨ooooOOOOO00000å¾ˆå®¹æ˜“æ–­ä¸‹ï¼Œåœ¨oO0OooOo0oOå®¹æ˜“å´©æºƒï¼Œä¸è¿‡èƒ½åœ¨é¦–éƒ¨æ–­ä¸‹å³å¯ä¿®æ”¹pcåˆ°å…¶ä»–åœ°å€(ä¸è¿‡è¿™ä¸ªè¿‡ç¨‹ä»ä¸å¤ªé¡ºåˆ©ï¼Œpcä¼šè·³å˜å›å»ï¼Œå¯èƒ½æ˜¯ä¸€ç›´å‘åŒ…å­˜åœ¨çº¿ç¨‹å¤„ç†ä¸å½“çš„é—®é¢˜)ã€‚<br>
è°ƒè¯•å¯çŸ¥(å›¾æœªå­˜XD)ooooOOOOO00000å‡½æ•°è¿”å›ä¸€ä¸ª16ç›´æ¥çš„å­—ç¬¦ä¸²ï¼Œå……å½“åç»­aesåŠ å¯†çš„ivï¼Œè€ŒoO0OooOo0oOè´Ÿè´£åŠ å¯†ï¼Œä¸ºé­”æ”¹AES_256_CBCå’ŒRC4ï¼ŒAESå’Œrc4çš„keyæˆ–ivå¯ä»¥è°ƒè¯•è·å–ã€‚</p>
<blockquote>
<p>åŠ å¯†å†…å®¹36å­—èŠ‚ï¼Œzer0å¡«å……åAESåŠ å¯†äº†48å­—èŠ‚ï¼ŒRC4åŠ å¯†32å­—èŠ‚åè¿”å›ï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯ä¸¢äº†4å­—èŠ‚ï¼Œä¹Ÿæ˜¯åæ¥ç¾¤é€šçŸ¥flagè¡¥ä¸Š â€œ65bdâ€ã€‚</p>
</blockquote>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/26689190/1682999195707-30715d89-666a-417b-a188-bcb50f09f121.png#averageHue=%23fcd9d9&amp;clientId=u98a88316-5810-4&amp;from=paste&amp;height=362&amp;id=ud040acec&amp;originHeight=453&amp;originWidth=808&amp;originalType=binary&amp;ratio=1.25&amp;rotation=0&amp;showTitle=false&amp;size=60074&amp;status=done&amp;style=none&amp;taskId=u41be0252-d7ad-41dd-83bd-48cf7377016&amp;title=&amp;width=646.4" srcset="/img/loading.gif" lazyload alt="image.png"><br>
AES256é­”æ”¹äº†Sç›’å’ŒåŠ å¯†æµç¨‹ï¼Œä½†å…·ä½“çš„å¤„ç†å‡½æ•°æ²¡æœ‰å˜åŠ¨,ä¼ªä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encrypt</span>(<span class="hljs-params">m:<span class="hljs-built_in">bytes</span>,exkey:<span class="hljs-built_in">list</span></span>):</span>  <span class="hljs-comment">#é­”æ”¹</span><br>    ms=<span class="hljs-built_in">list</span>(m)<br>    round_key(ms,exkey[:<span class="hljs-number">16</span>])<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,Nr):<br>        byte_sub(ms)<br>        mix_col(ms)<br>        row_shift(ms)             <span class="hljs-comment">#mixå’Œshiftçš„é¡ºåº</span><br>        round_key(ms,exkey[<span class="hljs-number">16</span>*i:<span class="hljs-number">16</span>*i+<span class="hljs-number">16</span>])<br>    byte_sub(ms)<br>    row_shift(ms)<br>    round_key(ms, exkey[<span class="hljs-number">16</span>*Nr:])<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(ms)<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decrypt</span>(<span class="hljs-params">ec:<span class="hljs-built_in">bytes</span>,exkey:<span class="hljs-built_in">list</span></span>):</span><br>    ec=<span class="hljs-built_in">list</span>(ec)<br>    round_key(ec, exkey[<span class="hljs-number">16</span> * Nr:])<br>    inv_row_shift(ec)<br>    inv_sub(ec)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(Nr-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>        round_key(ec, exkey[<span class="hljs-number">16</span> * i:<span class="hljs-number">16</span> * i + <span class="hljs-number">16</span>])<br>        inv_row_shift(ec)<br>        inv_mix_col(ec)<br>        inv_sub(ec)<br>    round_key(ec, exkey[:<span class="hljs-number">16</span>])<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(ec)<br><br>enc=<span class="hljs-string">'a6622e62f77ac35c6bf574446d8af6b2a48444f0f78ea1d0dd09c662270874e9'</span><br>rc4k=<span class="hljs-string">'SKJ&lt;HANIOSHDLJKa'</span><br>c=<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">'43a7e60d237e472964b3b98e08f76cce938078a61bc23b32653865e3af2dfff9'</span>)<br>exk=key_ext(<span class="hljs-string">b'A SIMPLE KEY!!!!!!!!!!!!!!!!!!!!'</span>)<br>iv=<span class="hljs-string">b'3d354e98963a69b2'</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(c),<span class="hljs-number">16</span>):<br>    res=decrypt(c[i:i+<span class="hljs-number">16</span>],exk)<br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(res[p]^iv[p]),end=<span class="hljs-string">''</span>)<br>    iv=c[i:i+<span class="hljs-number">16</span>]<br><span class="hljs-comment">#dd4ee7c9-031c-4073-bba5-a3efa8fe65bd</span><br></code></pre></td></tr></tbody></table></figure>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/CTF-Memory/">CTF Memory</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/RE/">RE</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/02/21/VNCTF2023-RE/">
                        <span class="hidden-mobile">VNCTF2023</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js" ></script>
  
  
    <script  src="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js" ></script>
  
  
    <script defer src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js" ></script>
  






  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>


</body>
</html>
