

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/QQ图片20211218184601.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Lu1u">
  <meta name="keywords" content="">
  
    <meta name="description" content="2021NCTF-部分RE题目解析">
<meta property="og:type" content="article">
<meta property="og:title" content="2021NCTF-Re">
<meta property="og:url" content="http://example.com/2021/12/01/2021NCTF-RE/index.html">
<meta property="og:site_name" content="Lightu">
<meta property="og:description" content="2021NCTF-部分RE题目解析">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/88ccec55e64a1.jpg">
<meta property="article:published_time" content="2021-12-01T02:27:36.000Z">
<meta property="article:modified_time" content="2022-09-27T14:42:23.747Z">
<meta property="article:author" content="Lightu&#39;s Blog">
<meta property="article:tag" content="RE">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/88ccec55e64a1.jpg">
  
  
  <title>2021NCTF-Re - Lightu</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0,"placement":"right"},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"follow_dnt":true},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Lightu&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/wallhaven-l3v7pr.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="2021NCTF-Re">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-12-01 10:27" pubdate>
        2021年12月1日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      17k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      140 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2021NCTF-Re</h1>
            
            <div class="markdown-body">
              <h1>NCTF-RE</h1>
<h2 id="签到">签到</h2>
<p><strong>送IDA又送flag</strong></p>
<p><strong>欢迎来到NCTF-逆向工程(Reverse Engineering)</strong><br>
<strong>这里可能有你需要的工具:</strong><br>
<strong>ida pro 7.6 :</strong></p>
<p><strong>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1bV2HjBBX0bwwtzORqhErOg">https://pan.baidu.com/s/1bV2HjBBX0bwwtzORqhErOg</a></strong></p>
<p><strong>提取码：o49x</strong></p>
<h2 id="Shadowbringer">Shadowbringer</h2>
<p>c++64位程序，ida载入</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><pre><code class="hljs c"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::<span class="hljs-built_in">string</span>(v4, <span class="hljs-string">"U&gt;F2UsQXN`5sXMELT=:7M_2&lt;X]^1ThaWF0=KM?9IUhAsTM5:T==_Ns&amp;&lt;Vhb!"</span>, &amp;v6);<br>  <span class="hljs-built_in">std</span>::allocator&lt;<span class="hljs-keyword">char</span>&gt;::~allocator(&amp;v6);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-keyword">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="hljs-string">"Welcome.Please input your flag:\n"</span>);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-keyword">operator</span>&gt;&gt;&lt;<span class="hljs-keyword">char</span>&gt;(refptr__ZSt3cin, (<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)input);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::<span class="hljs-built_in">string</span>((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v8, (<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)input);<span class="hljs-comment">// strcpy</span><br>  base64encode1((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v7, (<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v8);<span class="hljs-comment">// 换表的base64</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::<span class="hljs-keyword">operator</span>=((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)input, (<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v7);<span class="hljs-comment">// 赋值 第一层密文</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v7);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v8);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::<span class="hljs-built_in">string</span>((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v10, (<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)input);<span class="hljs-comment">// 复制一个对象v10</span><br>  base64encode2((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v9, (<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v10); <span class="hljs-comment">// base64换表 两次 不同的表</span><br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::<span class="hljs-keyword">operator</span>=((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)input, (<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v9);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v9);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v10);<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> __int8)<span class="hljs-built_in">std</span>::<span class="hljs-keyword">operator</span>==&lt;<span class="hljs-keyword">char</span>&gt;(input, v4) )<br>    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-keyword">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="hljs-string">"Right."</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">operator</span>&lt;&lt;&lt;<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-keyword">char</span>&gt;&gt;(refptr__ZSt4cout, <span class="hljs-string">"Wrong."</span>);<br>  <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v4);<br></code></pre></td></tr></tbody></table></figure>
<p>主要用到了c++ string类来进行处理，结合动调，大致经过了两次base64变表加密，在和v4进行比较。<br>
<strong>第一组表，</strong><br>
<strong>‘#$%&amp;’,27h,‘()*+,-.s0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[h]’+‘^_`ab’</strong></p>
<p><strong>第二组表</strong><br>
<strong>‘ba`_^]h[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210s.-,+*)(’,27h,‘&amp;’‘+’%$#’</strong></p>
<p>两次加密的代码大致相同，主要通过表的长度和每次处理的二进制长度判断为base64.</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-built_in">std</span>::<span class="hljs-built_in">bitset</span>&lt;8ull&gt;::to_string(v13, v14);     <span class="hljs-comment">// 转为2进制</span><br><span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; (<span class="hljs-keyword">unsigned</span> __int64)<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::size((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)&amp;v9); j += <span class="hljs-number">6</span> )<span class="hljs-comment">// 6个二进制一组</span><br>v7 = (<span class="hljs-keyword">char</span> *)<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::<span class="hljs-keyword">operator</span>[](&amp;hisoralce, v6);<span class="hljs-comment">//表索引</span><br><br><span class="hljs-keyword">while</span> ( (<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::size(a1) &amp; <span class="hljs-number">3</span>) != <span class="hljs-number">0</span> )<br>  {<br>    <span class="hljs-built_in">std</span>::<span class="hljs-keyword">operator</span>+&lt;<span class="hljs-keyword">char</span>&gt;(v19, a1, <span class="hljs-string">'!'</span>);<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::<span class="hljs-keyword">operator</span>=(a1, (<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v19);<br>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>::~<span class="hljs-built_in">string</span>((<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> *)v19);<br>  }<br><span class="hljs-comment">//不为4的倍数就不断+!</span><br></code></pre></td></tr></tbody></table></figure>
<p>了解流程后写解密脚本即可</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>table1=<span class="hljs-string">'#$%&amp;'</span>+<span class="hljs-string">'\x27'</span>+<span class="hljs-string">'()*+,-.s0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[h]'</span>+<span class="hljs-string">'^_`ab'</span><br>table2=<span class="hljs-string">'ba`_^]h[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210s.-,+*)('</span>+<span class="hljs-string">'\x27'</span>+<span class="hljs-string">'&amp;%$#'</span><br>base=<span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span><br>enc=<span class="hljs-string">'U&gt;F2UsQXN`5sXMELT=:7M_2&lt;X]^1ThaWF0=KM?9IUhAsTM5:T==_Ns&amp;&lt;Vhb!'</span><br><span class="hljs-comment">#enc='FsJ7M?b&lt;U-&gt;2M&gt;U:'#123456789测试</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">newbase</span>(<span class="hljs-params">enc,table</span>):</span><br>    m=<span class="hljs-string">''</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>        <span class="hljs-keyword">if</span> enc[i] <span class="hljs-keyword">in</span> table:<br>            m+=base[table.index(enc[i])]<br>        <span class="hljs-keyword">else</span>:<br>            m+=<span class="hljs-string">'='</span><br>    <span class="hljs-built_in">print</span>(base64.b64decode(m))<br>    <span class="hljs-keyword">return</span> base64.b64decode(m)<br>c1=newbase(enc,table2).decode()<br>newbase(c1,table1)<br><span class="hljs-comment">#NCTF{H0m3_r1d1n9_h0m3_dy1n9_h0p3}</span><br></code></pre></td></tr></tbody></table></figure>
<h2 id="鲨鲨的秘密">鲨鲨的秘密</h2>
<p>32位程序,ida载入</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">IpAdress = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x20</span>u);<br> VirtualProtect(IpAdress, <span class="hljs-number">0x20</span>u, <span class="hljs-number">0x40</span>u, &amp;flOldProtect);<br> dword_404E48 = (<span class="hljs-keyword">int</span>)IpAdress;<br> *(_BYTE *)IpAdress = <span class="hljs-number">0xC3</span>;                    <span class="hljs-comment">// ret的机器码</span><br> ((<span class="hljs-keyword">void</span> (*)(<span class="hljs-keyword">void</span>))IpAdress)<br></code></pre></td></tr></tbody></table></figure>
<p><strong>刚载入就有种莫名其妙的熟悉感，和西湖论剑的一道逆向题思路差不多，又是体力活。</strong><br>
是一种修改代码的操作数并单语句执行的SMC，通过一个数组来确定赋值代码长度的大小，和选定相应的操作数和修改的位置。</p>
<p>挖出汇编代码，结合动调分析语句还原算法。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c">mov     ds:dword_403474, <span class="hljs-number">0F</span>FFFFFFFh            <span class="hljs-comment">// mov output ,0xffffffff</span><br>mov     ecx, ds:dword_403464                         <span class="hljs-comment">// mov ecx,index(0) </span><br>mov     dl, byte ptr ds:VirtualProtect[ecx]        <span class="hljs-comment">// mov dl,input[0]</span><br>mov     byte ptr ds:dword_403470, dl             <span class="hljs-comment">// mov temp,dl</span><br>movzx   eax, byte ptr ds:dword_403470         <span class="hljs-comment">//  mov eax, temp  输入传给eax</span><br><span class="hljs-keyword">xor</span>     eax, ds:dword_403474                          <span class="hljs-comment">//  xor   eax,output 取反类似</span><br>mov     byte ptr ds:dword_403470, al            <span class="hljs-comment">//   mov temp , al  保存取反的值</span><br>movzx   ecx, byte ptr ds:dword_403470        <span class="hljs-comment">//   mov ecx,temp </span><br><span class="hljs-keyword">and</span>     ecx, <span class="hljs-number">0F</span>Fh                                             <span class="hljs-comment">//   and  ecx,0xff</span><br>mov     byte ptr ds:dword_403470, cl            <span class="hljs-comment">//   mov temp,cl</span><br>mov     edx, ds:dword_403474                      <span class="hljs-comment">//    mov edx,output </span><br>shr     edx,   <span class="hljs-number">8</span>                                                 <span class="hljs-comment">//    shr   edx,8</span><br>mov     ds:dword_403474, edx                      <span class="hljs-comment">//    mov output,edx</span><br>movzx   eax, byte ptr ds:dword_403470       <span class="hljs-comment">//    mov eax,temp</span><br>mov     ecx, ds:dword_403474                         <span class="hljs-comment">//    mov ecx,output</span><br><span class="hljs-keyword">xor</span>     ecx, dword ptr ds:byte_403058[eax*<span class="hljs-number">4</span>]     <span class="hljs-comment">//  xor ecx, sbox[4*eax]   //174841BC  xor sbox[4*0x9e] 结果保存到output</span><br>mov     ds:dword_403474, ecx                              <br>mov     edx, ds:dword_403464                            ....<br>mov     al, [edx+<span class="hljs-number">403005</span>h]		<br>mov     byte ptr ds:dword_403470, al		<br>movzx   ecx, byte ptr ds:dword_403470		<br><span class="hljs-keyword">xor</span>     ecx, ds:dword_403474		<br>mov     byte ptr ds:dword_403470, cl	<br>mov     edx, ds:dword_403474<br>shr     edx, <span class="hljs-number">8</span><br>mov     ds:dword_403474, edx<br>movzx   eax, byte ptr ds:dword_403470<br>mov     ecx, ds:dword_403474<br><span class="hljs-keyword">xor</span>     ecx, dword ptr ds:byte_403058[eax*<span class="hljs-number">4</span>]     <span class="hljs-comment">//xor ecx,sbox[4*eax]  //eax 0xdd</span><br>mov     ds:dword_403474, ecx		            <span class="hljs-comment">//mov output,ecx</span><br>mov     edx, ds:dword_403474                            <span class="hljs-comment">//mov edx,output</span><br><span class="hljs-keyword">xor</span>     edx, <span class="hljs-number">0F</span>FFFFFFFh		           <span class="hljs-comment">//xor     edx, 0FFFFFFFFh</span><br>mov     ds:dword_403474, edx                          <span class="hljs-comment">//mov    output edx</span><br><br></code></pre></td></tr></tbody></table></figure>
<p>python代码如下</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">input</span>=<span class="hljs-string">'a'</span>*<span class="hljs-number">40</span><br>output=<span class="hljs-number">0xffffffff</span><br><span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">40</span>,<span class="hljs-number">2</span>):<br>        tmp=(<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">input</span>[index])^output)&amp;<span class="hljs-number">0xff</span><br>        output=output&gt;&gt;<span class="hljs-number">8</span><br>        output=output^somebox[tmp]<br>        <span class="hljs-comment">#print("%x %x"%(tmp,output))</span><br>        tmp = (<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">input</span>[index+<span class="hljs-number">1</span>]) ^ output) &amp; <span class="hljs-number">0xff</span><br>        output = output &gt;&gt; <span class="hljs-number">8</span><br>        output = output ^ somebox[tmp]<br>        output=output^<span class="hljs-number">0xffffffff</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">"%x %x"</span> % (tmp, output))<br></code></pre></td></tr></tbody></table></figure>
<p><strong>可知是两个字节为一组进行的处理，z3解因为涉及下标问题不好下手，z3所得中间方程REF的参数不能转换为其他类型的变量，所以直接爆破。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">somebox=[<span class="hljs-number">0x00000000</span>, <span class="hljs-number">0x77073096</span>, <span class="hljs-number">0xEE0E612C</span>, <span class="hljs-number">0x990951BA</span>, <span class="hljs-number">0x076DC419</span>, <span class="hljs-number">0x706AF48F</span>, <span class="hljs-number">0xE963A535</span>, <span class="hljs-number">0x9E6495A3</span>, <span class="hljs-number">0x0EDB8832</span>, <span class="hljs-number">0x79DCB8A4</span>, <span class="hljs-number">0xE0D5E91E</span>, <span class="hljs-number">0x97D2D988</span>, <span class="hljs-number">0x09B64C2B</span>, <span class="hljs-number">0x7EB17CBD</span>, <span class="hljs-number">0xE7B82D07</span>, <span class="hljs-number">0x90BF1D91</span>, <span class="hljs-number">0x1DB71064</span>, <span class="hljs-number">0x6AB020F2</span>, <span class="hljs-number">0xF3B97148</span>, <span class="hljs-number">0x84BE41DE</span>, <span class="hljs-number">0x1ADAD47D</span>, <span class="hljs-number">0x6DDDE4EB</span>, <span class="hljs-number">0xF4D4B551</span>, <span class="hljs-number">0x83D385C7</span>, <span class="hljs-number">0x136C9856</span>, <span class="hljs-number">0x646BA8C0</span>, <span class="hljs-number">0xFD62F97A</span>, <span class="hljs-number">0x8A65C9EC</span>, <span class="hljs-number">0x14015C4F</span>, <span class="hljs-number">0x63066CD9</span>, <span class="hljs-number">0xFA0F3D63</span>, <span class="hljs-number">0x8D080DF5</span>, <span class="hljs-number">0x3B6E20C8</span>, <span class="hljs-number">0x4C69105E</span>, <span class="hljs-number">0xD56041E4</span>, <span class="hljs-number">0xA2677172</span>, <span class="hljs-number">0x3C03E4D1</span>, <span class="hljs-number">0x4B04D447</span>, <span class="hljs-number">0xD20D85FD</span>, <span class="hljs-number">0xA50AB56B</span>, <span class="hljs-number">0x35B5A8FA</span>, <span class="hljs-number">0x42B2986C</span>, <span class="hljs-number">0xDBBBC9D6</span>, <span class="hljs-number">0xACBCF940</span>, <span class="hljs-number">0x32D86CE3</span>, <span class="hljs-number">0x45DF5C75</span>, <span class="hljs-number">0xDCD60DCF</span>, <span class="hljs-number">0xABD13D59</span>, <span class="hljs-number">0x26D930AC</span>, <span class="hljs-number">0x51DE003A</span>, <span class="hljs-number">0xC8D75180</span>, <span class="hljs-number">0xBFD06116</span>, <span class="hljs-number">0x21B4F4B5</span>, <span class="hljs-number">0x56B3C423</span>, <span class="hljs-number">0xCFBA9599</span>, <span class="hljs-number">0xB8BDA50F</span>, <span class="hljs-number">0x2802B89E</span>, <span class="hljs-number">0x5F058808</span>, <span class="hljs-number">0xC60CD9B2</span>, <span class="hljs-number">0xB10BE924</span>, <span class="hljs-number">0x2F6F7C87</span>, <span class="hljs-number">0x58684C11</span>, <span class="hljs-number">0xC1611DAB</span>, <span class="hljs-number">0xB6662D3D</span>, <span class="hljs-number">0x76DC4190</span>, <span class="hljs-number">0x01DB7106</span>, <span class="hljs-number">0x98D220BC</span>, <span class="hljs-number">0xEFD5102A</span>, <span class="hljs-number">0x71B18589</span>, <span class="hljs-number">0x06B6B51F</span>, <span class="hljs-number">0x9FBFE4A5</span>, <span class="hljs-number">0xE8B8D433</span>, <span class="hljs-number">0x7807C9A2</span>, <span class="hljs-number">0x0F00F934</span>, <span class="hljs-number">0x9609A88E</span>, <span class="hljs-number">0xE10E9818</span>, <span class="hljs-number">0x7F6A0DBB</span>, <span class="hljs-number">0x086D3D2D</span>, <span class="hljs-number">0x91646C97</span>, <span class="hljs-number">0xE6635C01</span>, <span class="hljs-number">0x6B6B51F4</span>, <span class="hljs-number">0x1C6C6162</span>, <span class="hljs-number">0x856530D8</span>, <span class="hljs-number">0xF262004E</span>, <span class="hljs-number">0x6C0695ED</span>, <span class="hljs-number">0x1B01A57B</span>, <span class="hljs-number">0x8208F4C1</span>, <span class="hljs-number">0xF50FC457</span>, <span class="hljs-number">0x65B0D9C6</span>, <span class="hljs-number">0x12B7E950</span>, <span class="hljs-number">0x8BBEB8EA</span>, <span class="hljs-number">0xFCB9887C</span>, <span class="hljs-number">0x62DD1DDF</span>, <span class="hljs-number">0x15DA2D49</span>, <span class="hljs-number">0x8CD37CF3</span>, <span class="hljs-number">0xFBD44C65</span>, <span class="hljs-number">0x4DB26158</span>, <span class="hljs-number">0x3AB551CE</span>, <span class="hljs-number">0xA3BC0074</span>, <span class="hljs-number">0xD4BB30E2</span>, <span class="hljs-number">0x4ADFA541</span>, <span class="hljs-number">0x3DD895D7</span>, <span class="hljs-number">0xA4D1C46D</span>, <span class="hljs-number">0xD3D6F4FB</span>, <span class="hljs-number">0x4369E96A</span>, <span class="hljs-number">0x346ED9FC</span>, <span class="hljs-number">0xAD678846</span>, <span class="hljs-number">0xDA60B8D0</span>, <span class="hljs-number">0x44042D73</span>, <span class="hljs-number">0x33031DE5</span>, <span class="hljs-number">0xAA0A4C5F</span>, <span class="hljs-number">0xDD0D7CC9</span>, <span class="hljs-number">0x5005713C</span>, <span class="hljs-number">0x270241AA</span>, <span class="hljs-number">0xBE0B1010</span>, <span class="hljs-number">0xC90C2086</span>, <span class="hljs-number">0x5768B525</span>, <span class="hljs-number">0x206F85B3</span>, <span class="hljs-number">0xB966D409</span>, <span class="hljs-number">0xCE61E49F</span>, <span class="hljs-number">0x5EDEF90E</span>, <span class="hljs-number">0x29D9C998</span>, <span class="hljs-number">0xB0D09822</span>, <span class="hljs-number">0xC7D7A8B4</span>, <span class="hljs-number">0x59B33D17</span>, <span class="hljs-number">0x2EB40D81</span>, <span class="hljs-number">0xB7BD5C3B</span>, <span class="hljs-number">0xC0BA6CAD</span>, <span class="hljs-number">0xEDB88320</span>, <span class="hljs-number">0x9ABFB3B6</span>, <span class="hljs-number">0x03B6E20C</span>, <span class="hljs-number">0x74B1D29A</span>, <span class="hljs-number">0xEAD54739</span>, <span class="hljs-number">0x9DD277AF</span>, <span class="hljs-number">0x04DB2615</span>, <span class="hljs-number">0x73DC1683</span>, <span class="hljs-number">0xE3630B12</span>, <span class="hljs-number">0x94643B84</span>, <span class="hljs-number">0x0D6D6A3E</span>, <span class="hljs-number">0x7A6A5AA8</span>, <span class="hljs-number">0xE40ECF0B</span>, <span class="hljs-number">0x9309FF9D</span>, <span class="hljs-number">0x0A00AE27</span>, <span class="hljs-number">0x7D079EB1</span>, <span class="hljs-number">0xF00F9344</span>, <span class="hljs-number">0x8708A3D2</span>, <span class="hljs-number">0x1E01F268</span>, <span class="hljs-number">0x6906C2FE</span>, <span class="hljs-number">0xF762575D</span>, <span class="hljs-number">0x806567CB</span>, <span class="hljs-number">0x196C3671</span>, <span class="hljs-number">0x6E6B06E7</span>, <span class="hljs-number">0xFED41B76</span>, <span class="hljs-number">0x89D32BE0</span>, <span class="hljs-number">0x10DA7A5A</span>, <span class="hljs-number">0x67DD4ACC</span>, <span class="hljs-number">0xF9B9DF6F</span>, <span class="hljs-number">0x8EBEEFF9</span>, <span class="hljs-number">0x17B7BE43</span>, <span class="hljs-number">0x60B08ED5</span>, <span class="hljs-number">0xD6D6A3E8</span>, <span class="hljs-number">0xA1D1937E</span>, <span class="hljs-number">0x38D8C2C4</span>, <span class="hljs-number">0x4FDFF252</span>, <span class="hljs-number">0xD1BB67F1</span>, <span class="hljs-number">0xA6BC5767</span>, <span class="hljs-number">0x3FB506DD</span>, <span class="hljs-number">0x48B2364B</span>, <span class="hljs-number">0xD80D2BDA</span>, <span class="hljs-number">0xAF0A1B4C</span>, <span class="hljs-number">0x36034AF6</span>, <span class="hljs-number">0x41047A60</span>, <span class="hljs-number">0xDF60EFC3</span>, <span class="hljs-number">0xA867DF55</span>, <span class="hljs-number">0x316E8EEF</span>, <span class="hljs-number">0x4669BE79</span>, <span class="hljs-number">0xCB61B38C</span>, <span class="hljs-number">0xBC66831A</span>, <span class="hljs-number">0x256FD2A0</span>, <span class="hljs-number">0x5268E236</span>, <span class="hljs-number">0xCC0C7795</span>, <span class="hljs-number">0xBB0B4703</span>, <span class="hljs-number">0x220216B9</span>, <span class="hljs-number">0x5505262F</span>, <span class="hljs-number">0xC5BA3BBE</span>, <span class="hljs-number">0xB2BD0B28</span>, <span class="hljs-number">0x2BB45A92</span>, <span class="hljs-number">0x5CB36A04</span>, <span class="hljs-number">0xC2D7FFA7</span>, <span class="hljs-number">0xB5D0CF31</span>, <span class="hljs-number">0x2CD99E8B</span>, <span class="hljs-number">0x5BDEAE1D</span>, <span class="hljs-number">0x9B64C2B0</span>, <span class="hljs-number">0xEC63F226</span>, <span class="hljs-number">0x756AA39C</span>, <span class="hljs-number">0x026D930A</span>, <span class="hljs-number">0x9C0906A9</span>, <span class="hljs-number">0xEB0E363F</span>, <span class="hljs-number">0x72076785</span>, <span class="hljs-number">0x05005713</span>, <span class="hljs-number">0x95BF4A82</span>, <span class="hljs-number">0xE2B87A14</span>, <span class="hljs-number">0x7BB12BAE</span>, <span class="hljs-number">0x0CB61B38</span>, <span class="hljs-number">0x92D28E9B</span>, <span class="hljs-number">0xE5D5BE0D</span>, <span class="hljs-number">0x7CDCEFB7</span>, <span class="hljs-number">0x0BDBDF21</span>, <span class="hljs-number">0x86D3D2D4</span>, <span class="hljs-number">0xF1D4E242</span>, <span class="hljs-number">0x68DDB3F8</span>, <span class="hljs-number">0x1FDA836E</span>, <span class="hljs-number">0x81BE16CD</span>, <span class="hljs-number">0xF6B9265B</span>, <span class="hljs-number">0x6FB077E1</span>, <span class="hljs-number">0x18B74777</span>, <span class="hljs-number">0x88085AE6</span>, <span class="hljs-number">0xFF0F6A70</span>, <span class="hljs-number">0x66063BCA</span>, <span class="hljs-number">0x11010B5C</span>, <span class="hljs-number">0x8F659EFF</span>, <span class="hljs-number">0xF862AE69</span>, <span class="hljs-number">0x616BFFD3</span>, <span class="hljs-number">0x166CCF45</span>, <span class="hljs-number">0xA00AE278</span>, <span class="hljs-number">0xD70DD2EE</span>, <span class="hljs-number">0x4E048354</span>, <span class="hljs-number">0x3903B3C2</span>, <span class="hljs-number">0xA7672661</span>, <span class="hljs-number">0xD06016F7</span>, <span class="hljs-number">0x4969474D</span>, <span class="hljs-number">0x3E6E77DB</span>, <span class="hljs-number">0xAED16A4A</span>, <span class="hljs-number">0xD9D65ADC</span>, <span class="hljs-number">0x40DF0B66</span>, <span class="hljs-number">0x37D83BF0</span>, <span class="hljs-number">0xA9BCAE53</span>, <span class="hljs-number">0xDEBB9EC5</span>, <span class="hljs-number">0x47B2CF7F</span>, <span class="hljs-number">0x30B5FFE9</span>, <span class="hljs-number">0xBDBDF21C</span>, <span class="hljs-number">0xCABAC28A</span>, <span class="hljs-number">0x53B39330</span>, <span class="hljs-number">0x24B4A3A6</span>, <span class="hljs-number">0xBAD03605</span>, <span class="hljs-number">0xCDD70693</span>, <span class="hljs-number">0x54DE5729</span>, <span class="hljs-number">0x23D967BF</span>, <span class="hljs-number">0xB3667A2E</span>, <span class="hljs-number">0xC4614AB8</span>, <span class="hljs-number">0x5D681B02</span>, <span class="hljs-number">0x2A6F2B94</span>, <span class="hljs-number">0xB40BBE37</span>, <span class="hljs-number">0xC30C8EA1</span>, <span class="hljs-number">0x5A05DF1B</span>, <span class="hljs-number">0x2D02EF8D</span>]<br>enc=[<span class="hljs-number">0xC0F6605E</span>, <span class="hljs-number">0x00B16E0A</span>, <span class="hljs-number">0x3319A2D2</span>, <span class="hljs-number">0x57CAB7B7</span>, <span class="hljs-number">0x9A646D9C</span>, <span class="hljs-number">0xBDD82726</span>, <span class="hljs-number">0xD838FB91</span>, <span class="hljs-number">0x8DE10BB3</span>, <span class="hljs-number">0x176B0DAD</span>, <span class="hljs-number">0x685FDEEF</span>, <span class="hljs-number">0x2C1FF7B1</span>, <span class="hljs-number">0x6C444296</span>, <span class="hljs-number">0xA15CFE90</span>, <span class="hljs-number">0x20CD8721</span>, <span class="hljs-number">0x62967CE8</span>, <span class="hljs-number">0x2C1641FD</span>, <span class="hljs-number">0x572D0F9A</span>, <span class="hljs-number">0xAE52DC2C</span>, <span class="hljs-number">0x50497DCF</span>, <span class="hljs-number">0xFF6ABF4A</span>]<br>s=<span class="hljs-string">''</span><br>enc=[<span class="hljs-number">0xC0F6605E</span>, <span class="hljs-number">0x00B16E0A</span>, <span class="hljs-number">0x3319A2D2</span>, <span class="hljs-number">0x57CAB7B7</span>, <span class="hljs-number">0x9A646D9C</span>, <span class="hljs-number">0xBDD82726</span>, <span class="hljs-number">0xD838FB91</span>, <span class="hljs-number">0x8DE10BB3</span>, <span class="hljs-number">0x176B0DAD</span>, <span class="hljs-number">0x685FDEEF</span>, <span class="hljs-number">0x2C1FF7B1</span>, <span class="hljs-number">0x6C444296</span>, <span class="hljs-number">0xA15CFE90</span>, <span class="hljs-number">0x20CD8721</span>, <span class="hljs-number">0x62967CE8</span>, <span class="hljs-number">0x2C1641FD</span>, <span class="hljs-number">0x572D0F9A</span>, <span class="hljs-number">0xAE52DC2C</span>, <span class="hljs-number">0x50497DCF</span>, <span class="hljs-number">0xFF6ABF4A</span>]<br><span class="hljs-keyword">for</span> i  <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    <span class="hljs-keyword">for</span>  m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">128</span>):<br>        <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">128</span>):<br>            output = <span class="hljs-number">0xffffffff</span><br>            tmp=(m^output)&amp;<span class="hljs-number">0xff</span><br>            output=output&gt;&gt;<span class="hljs-number">8</span><br>            output=output^somebox[tmp]<br>            <span class="hljs-comment">#print("%x %x"%(tmp,output))</span><br>            tmp = (n ^ output) &amp; <span class="hljs-number">0xff</span><br>            output = output &gt;&gt; <span class="hljs-number">8</span><br>            output = output ^ somebox[tmp]<br>            output=output^<span class="hljs-number">0xffffffff</span><br>            <span class="hljs-keyword">if</span> output==enc[i]:<br>                s+=<span class="hljs-built_in">chr</span>(m)+<span class="hljs-built_in">chr</span>(n)<br><br><span class="hljs-built_in">print</span>(s)<br><span class="hljs-comment">#NCTF{rLdE57TG0iHA39qUnFZp6LeJyYEBcxMNL7}</span><br></code></pre></td></tr></tbody></table></figure>
<h2 id="狗狗的秘密">狗狗的秘密</h2>
<p><strong>挺不错的，解完想暴打出题人。</strong><br>
32位程序，ida载入获得假flag一枚<br>
<img src="https://bu.dusays.com/2021/12/01/811a7364f1bd8.png" srcset="/img/loading.gif" lazyload alt=""><br>
不过main之前有个TlsCallback函数，直接下个断点，动态分析。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( !v9 &amp;&amp; !IsDebuggerPresent() )<br>   {<br>     off_825014 = (<span class="hljs-keyword">int</span> (__cdecl *)(_DWORD))sub_823000;<br>     v8 = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">char</span> *)sub_823000 + <span class="hljs-number">256</span>);<br>     <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">24</span>; ++i )<br>       v8 += <span class="hljs-number">2</span>;<br>     <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">24</span>; ++j )<br>     {<br>       v8 -= <span class="hljs-number">2</span>;<br>       sub_8211F0(v8);<br>     }<br>   }<br></code></pre></td></tr></tbody></table></figure>
<p>反调试，off_825014在主函数出现过，但是个假逻辑，所以这部分内容是SMC修改技术。</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">sub_8211F0</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *a1)</span></span><br><span class="hljs-function"></span>{<br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+0h] [ebp-Ch]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// [esp+4h] [ebp-8h]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// [esp+8h] [ebp-4h]</span><br><br>  v4 = *a1;<br>  v3 = a1[<span class="hljs-number">1</span>];<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; ++i )<br>  {<br>    v3 -= (dword_825004[(*(_DWORD *)delta &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>] + *(_DWORD *)delta) ^ (v4 + ((v4 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * v4)));<br>    *(_DWORD *)delta += dword_825000;<br>    v4 -= (dword_825004[delta[<span class="hljs-number">0</span>] &amp; <span class="hljs-number">3</span>] + *(_DWORD *)delta) ^ (v3 + ((v3 &gt;&gt; <span class="hljs-number">5</span>) ^ (<span class="hljs-number">16</span> * v3)));<br>  }<br>  *a1 = v4;<br>  result = v3;<br>  a1[<span class="hljs-number">1</span>] = v3;<br>  <span class="hljs-keyword">return</span> result;<br>}<br></code></pre></td></tr></tbody></table></figure>
<p><strong>直接改eip绕过这个反调试即可，同时修改代码用的xTea，不过delta的值有个小坑，main函数中有个创建线程的函数，将delta赋值为0xDA76C600，patch进行修改，后面下个断F9。</strong></p>
<blockquote>
<p>线程的执行顺序不是太清楚，不过TLSCALLBACK在main之前执行，而delta在main函数中被改掉，为什么会应用到smc中呢，有待解决。</p>
</blockquote>
<p><strong>修复函数后拿到真正处理逻辑。</strong></p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">sub_823000</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *a1)</span></span><br><span class="hljs-function"></span>{<br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v2; <span class="hljs-comment">// [esp+0h] [ebp-98h]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// [esp+10h] [ebp-88h]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// [esp+1Ch] [ebp-7Ch]</span><br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// [esp+2Ch] [ebp-6Ch]</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [esp+2Ch] [ebp-6Ch]</span><br>  <span class="hljs-keyword">char</span> v7; <span class="hljs-comment">// [esp+32h] [ebp-66h]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> Size; <span class="hljs-comment">// [esp+34h] [ebp-64h]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// [esp+38h] [ebp-60h]</span><br>  <span class="hljs-keyword">int</span> k; <span class="hljs-comment">// [esp+38h] [ebp-60h]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 *v11; <span class="hljs-comment">// [esp+3Ch] [ebp-5Ch]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+40h] [ebp-58h]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> j; <span class="hljs-comment">// [esp+40h] [ebp-58h]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> m; <span class="hljs-comment">// [esp+40h] [ebp-58h]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> n; <span class="hljs-comment">// [esp+40h] [ebp-58h]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> ii; <span class="hljs-comment">// [esp+40h] [ebp-58h]</span><br>  <span class="hljs-keyword">char</span> v17[<span class="hljs-number">62</span>]; <span class="hljs-comment">// [esp+44h] [ebp-54h]</span><br>  <span class="hljs-keyword">int</span> v18; <span class="hljs-comment">// [esp+82h] [ebp-16h]</span><br>  <span class="hljs-keyword">int</span> v19; <span class="hljs-comment">// [esp+86h] [ebp-12h]</span><br>  <span class="hljs-keyword">int</span> v20; <span class="hljs-comment">// [esp+8Ah] [ebp-Eh]</span><br>  <span class="hljs-keyword">int</span> v21; <span class="hljs-comment">// [esp+8Eh] [ebp-Ah]</span><br>  __int16 v22; <span class="hljs-comment">// [esp+92h] [ebp-6h]</span><br><br>  v3 = <span class="hljs-built_in">strlen</span>(a1);<br>  Size = <span class="hljs-number">146</span> * v3 / <span class="hljs-number">0x64</span> + <span class="hljs-number">1</span>;<br>  v4 = <span class="hljs-number">0</span>;<br>  v11 = (<span class="hljs-keyword">unsigned</span> __int8 *)<span class="hljs-built_in">malloc</span>(Size);<br>  v17[<span class="hljs-number">0</span>] = <span class="hljs-number">82</span>;<br>  v17[<span class="hljs-number">1</span>] = <span class="hljs-number">-61</span>;<br>  v17[<span class="hljs-number">2</span>] = <span class="hljs-number">26</span>;<br>  v17[<span class="hljs-number">3</span>] = <span class="hljs-number">-32</span>;<br>  v17[<span class="hljs-number">4</span>] = <span class="hljs-number">22</span>;<br>  v17[<span class="hljs-number">5</span>] = <span class="hljs-number">93</span>;<br>  v17[<span class="hljs-number">6</span>] = <span class="hljs-number">94</span>;<br>  v17[<span class="hljs-number">7</span>] = <span class="hljs-number">-30</span>;<br>  v17[<span class="hljs-number">8</span>] = <span class="hljs-number">103</span>;<br>  v17[<span class="hljs-number">9</span>] = <span class="hljs-number">31</span>;<br>  v17[<span class="hljs-number">10</span>] = <span class="hljs-number">31</span>;<br>  v17[<span class="hljs-number">11</span>] = <span class="hljs-number">6</span>;<br>  v17[<span class="hljs-number">12</span>] = <span class="hljs-number">6</span>;<br>  v17[<span class="hljs-number">13</span>] = <span class="hljs-number">31</span>;<br>  v17[<span class="hljs-number">14</span>] = <span class="hljs-number">23</span>;<br>  v17[<span class="hljs-number">15</span>] = <span class="hljs-number">6</span>;<br>  v17[<span class="hljs-number">16</span>] = <span class="hljs-number">15</span>;<br>  v17[<span class="hljs-number">17</span>] = <span class="hljs-number">-7</span>;<br>  v17[<span class="hljs-number">18</span>] = <span class="hljs-number">6</span>;<br>  v17[<span class="hljs-number">19</span>] = <span class="hljs-number">103</span>;<br>  v17[<span class="hljs-number">20</span>] = <span class="hljs-number">88</span>;<br>  v17[<span class="hljs-number">21</span>] = <span class="hljs-number">-78</span>;<br>  v17[<span class="hljs-number">22</span>] = <span class="hljs-number">-30</span>;<br>  v17[<span class="hljs-number">23</span>] = <span class="hljs-number">-116</span>;<br>  v17[<span class="hljs-number">24</span>] = <span class="hljs-number">15</span>;<br>  v17[<span class="hljs-number">25</span>] = <span class="hljs-number">42</span>;<br>  v17[<span class="hljs-number">26</span>] = <span class="hljs-number">6</span>;<br>  v17[<span class="hljs-number">27</span>] = <span class="hljs-number">-119</span>;<br>  v17[<span class="hljs-number">28</span>] = <span class="hljs-number">-49</span>;<br>  v17[<span class="hljs-number">29</span>] = <span class="hljs-number">42</span>;<br>  v17[<span class="hljs-number">30</span>] = <span class="hljs-number">6</span>;<br>  v17[<span class="hljs-number">31</span>] = <span class="hljs-number">31</span>;<br>  v17[<span class="hljs-number">32</span>] = <span class="hljs-number">-104</span>;<br>  v17[<span class="hljs-number">33</span>] = <span class="hljs-number">26</span>;<br>  v17[<span class="hljs-number">34</span>] = <span class="hljs-number">62</span>;<br>  v17[<span class="hljs-number">35</span>] = <span class="hljs-number">23</span>;<br>  v17[<span class="hljs-number">36</span>] = <span class="hljs-number">103</span>;<br>  v17[<span class="hljs-number">37</span>] = <span class="hljs-number">31</span>;<br>  v17[<span class="hljs-number">38</span>] = <span class="hljs-number">-9</span>;<br>  v17[<span class="hljs-number">39</span>] = <span class="hljs-number">58</span>;<br>  v17[<span class="hljs-number">40</span>] = <span class="hljs-number">68</span>;<br>  v17[<span class="hljs-number">41</span>] = <span class="hljs-number">-61</span>;<br>  v17[<span class="hljs-number">42</span>] = <span class="hljs-number">22</span>;<br>  v17[<span class="hljs-number">43</span>] = <span class="hljs-number">51</span>;<br>  v17[<span class="hljs-number">44</span>] = <span class="hljs-number">105</span>;<br>  v17[<span class="hljs-number">45</span>] = <span class="hljs-number">26</span>;<br>  v17[<span class="hljs-number">46</span>] = <span class="hljs-number">117</span>;<br>  v17[<span class="hljs-number">47</span>] = <span class="hljs-number">22</span>;<br>  v17[<span class="hljs-number">48</span>] = <span class="hljs-number">62</span>;<br>  v17[<span class="hljs-number">49</span>] = <span class="hljs-number">23</span>;<br>  v17[<span class="hljs-number">50</span>] = <span class="hljs-number">-43</span>;<br>  v17[<span class="hljs-number">51</span>] = <span class="hljs-number">105</span>;<br>  v17[<span class="hljs-number">52</span>] = <span class="hljs-number">122</span>;<br>  v17[<span class="hljs-number">53</span>] = <span class="hljs-number">27</span>;<br>  v17[<span class="hljs-number">54</span>] = <span class="hljs-number">68</span>;<br>  v17[<span class="hljs-number">55</span>] = <span class="hljs-number">68</span>;<br>  v17[<span class="hljs-number">56</span>] = <span class="hljs-number">62</span>;<br>  v17[<span class="hljs-number">57</span>] = <span class="hljs-number">103</span>;<br>  v17[<span class="hljs-number">58</span>] = <span class="hljs-number">-9</span>;<br>  v17[<span class="hljs-number">59</span>] = <span class="hljs-number">-119</span>;<br>  v17[<span class="hljs-number">60</span>] = <span class="hljs-number">103</span>;<br>  v17[<span class="hljs-number">61</span>] = <span class="hljs-number">-61</span>;<br>  v18 = <span class="hljs-number">0</span>;<br>  v19 = <span class="hljs-number">0</span>;<br>  v20 = <span class="hljs-number">0</span>;<br>  v21 = <span class="hljs-number">0</span>;<br>  v22 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">memset</span>(v11, <span class="hljs-number">0</span>, Size);<br>  v9 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">256</span>; ++i )<br>  {<br>    v7 = byte_825018[i];<br>    byte_825018[i] = byte_825018[(i + *((<span class="hljs-keyword">unsigned</span> __int8 *)&amp;delta + i % <span class="hljs-number">4</span>)) % <span class="hljs-number">256</span>];<span class="hljs-comment">// delta变为0了</span><br>    byte_825018[(i + *((<span class="hljs-keyword">unsigned</span> __int8 *)&amp;delta + i % <span class="hljs-number">4</span>)) % <span class="hljs-number">256</span>] = v7;<br>  }<br>  <span class="hljs-keyword">while</span> ( v9 &lt; <span class="hljs-built_in">strlen</span>(a1) )<br>  {<br>    v5 = a1[v9];<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">146</span> * v3 / <span class="hljs-number">0x64</span>; ; --j )<br>    {<br>      v6 = v5 + (v11[j] &lt;&lt; <span class="hljs-number">8</span>);<br>      v11[j] = v6 % <span class="hljs-number">47</span>;<br>      v5 = v6 / <span class="hljs-number">47</span>;<br>      <span class="hljs-keyword">if</span> ( j &lt; v4 )<br>        v4 = j;<br>      <span class="hljs-keyword">if</span> ( !v5 &amp;&amp; j &lt;= v4 )<br>        <span class="hljs-keyword">break</span>;<br>    }<br>    ++v9;<br>  }<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; !v11[k]; ++k )<br>    ;<br>  <span class="hljs-keyword">for</span> ( m = <span class="hljs-number">0</span>; m &lt; Size; ++m )<br>    v11[m] = byte_825118[v11[k++]];             <span class="hljs-comment">// 单表替换</span><br>  <span class="hljs-keyword">while</span> ( m &lt; Size )<br>    v11[m++] = <span class="hljs-number">0</span>;<br>  v2 = <span class="hljs-built_in">strlen</span>((<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *)v11);<br>  <span class="hljs-keyword">for</span> ( n = <span class="hljs-number">0</span>; n &lt; v2; ++n )<br>    v11[n] ^= byte_825018[v11[n]];              <span class="hljs-comment">// 异或处理</span><br>  <span class="hljs-keyword">for</span> ( ii = <span class="hljs-number">0</span>; ii &lt; v2; ++ii )<br>  {<br>    <span class="hljs-keyword">if</span> ( v11[ii] != (<span class="hljs-keyword">unsigned</span> __int8)v17[ii] )<br>    {<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Wrong!\n"</span>, v2);<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    }<br>  }<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Right!\n"</span>, v2);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>}<br></code></pre></td></tr></tbody></table></figure>
<p><strong>delta的值是0，需要注意一下，接着就是写脚本逆向，z3不好直接求解，加密流程是先将输入转为47进制下每位的值存在数组v11中，找到第一个非0值的下标k，接着进行单表替换和异或。</strong></p>
<blockquote>
<p>又是一个z3直接出，却被ban了的题，类型转换有点坑</p>
</blockquote>
<p><strong>因为涉及到表索引和本身异或不好逆向还原，所以想着先爆破v11数组。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">enc=[<span class="hljs-number">0x52</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xC3</span>]<br>c=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">61</span>):<br>    temp=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">47</span>):<br>        tmp=tb2[j]<br>        tmp=tmp^table[tmp]<br>        <span class="hljs-keyword">if</span> tmp==enc[i]:<br>            temp.append(j)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(temp)==<span class="hljs-number">1</span>:<br>        c.append(temp[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">else</span>:<br>        c.append(temp)<br>c.insert(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br><br><span class="hljs-comment">#[0, 2, 0, [33, 45], 44, 30, 40, 8, 23, [7, 11, 22], [34, 37], [34, 37], [19, 20, 43], [19, 20, 43], [34, 37], 24, [19, 20, 43], [4, 31], 29, [19, 20, 43], [7, 11, 22], 13, 5, 23, 41, [4, 31], 35, [19, 20, 43], 9, 14, 35, [19, 20, 43], [34, 37], 3, [33, 45], 10, 24, [7, 11, 22], [34, 37], 38, 1, 25, 0, 30, 6, 42, [33, 45], 36, 30, 10, 24, 21, 42, 26, 28, 25, 25, 10, [7, 11, 22], 38, 9, [7, 11, 22]]</span><br></code></pre></td></tr></tbody></table></figure>
<p><strong>v11第一位是0，根据加密的最后一位是0xc3，或者多次测试都可知，不过这解有点多，下面就是对c进行排列组合，之后47进制转，long_to_bytes下即可，不过这…tmd，dfs不太会写，直接硬爆破了，大概跑了半小时,直接整emo了。</strong></p>
<blockquote>
<p>跑起来才意识到从高位开始爆破会比较快，高位对转字符的影响较大，傻了</p>
</blockquote>
<p>完整如下</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dododo</span>(<span class="hljs-params">c</span>):</span><br>    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">62</span>):<br>        <span class="hljs-built_in">sum</span> += c[i] * <span class="hljs-built_in">pow</span>(<span class="hljs-number">47</span>, <span class="hljs-number">61</span> - i)<br>    m=long_to_bytes(<span class="hljs-built_in">sum</span>)<br>    <span class="hljs-keyword">try</span>:<br>        flag=m.decode()<br>        <span class="hljs-built_in">print</span>(flag)<br>        exit(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><br><br>enc=[<span class="hljs-number">0x52</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xC3</span>]<br>table=[<span class="hljs-number">0x21</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xDF</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xFC</span>]<br><span class="hljs-comment">#delta=[0,0xc6,0x76,0xda]</span><br>tb2=[<span class="hljs-number">0xA7</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x00</span>]<br><br>c=[]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">61</span>):<br>    temp=[]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">47</span>):<br>        tmp=tb2[j]<br>        tmp=tmp^table[tmp]<br>        <span class="hljs-keyword">if</span> tmp==enc[i]:<br>            temp.append(j)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(temp)==<span class="hljs-number">1</span>:<br>        c.append(temp[<span class="hljs-number">0</span>])<br>    <span class="hljs-keyword">else</span>:<br>        c.append(temp)<br>c.insert(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br><span class="hljs-built_in">print</span>(c)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(i,<span class="hljs-built_in">int</span>):<br>        <span class="hljs-keyword">pass</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(i)<br>c[<span class="hljs-number">3</span>]=<span class="hljs-number">45</span><br>tblen=[]<br>l=<span class="hljs-number">1</span><br>index=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    <span class="hljs-keyword">try</span>:<br>        tblen.append(<span class="hljs-built_in">len</span>(c[i]))<br>        l*=<span class="hljs-built_in">len</span>(c[i])<br>        index.append(i)<br>    <span class="hljs-keyword">except</span>:<br>        tblen.append(<span class="hljs-number">1</span>)<br><br><span class="hljs-built_in">print</span>(tblen)<br><span class="hljs-built_in">print</span>(index)<br><br><span class="hljs-built_in">sum</span>=<span class="hljs-number">0</span><br>t1=[<span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">22</span>]<br>t2=[<span class="hljs-number">34</span>, <span class="hljs-number">37</span>]<br>t3=[<span class="hljs-number">19</span>, <span class="hljs-number">20</span>, <span class="hljs-number">43</span>]<br>t4=[<span class="hljs-number">4</span>, <span class="hljs-number">31</span>]<br>t5=[<span class="hljs-number">33</span>, <span class="hljs-number">45</span>]<br><br><br><span class="hljs-keyword">for</span>  a1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    c[<span class="hljs-number">9</span>]=t1[a1]<br>    <span class="hljs-keyword">for</span> a2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>        c[<span class="hljs-number">10</span>]=t2[a2]<br>        <span class="hljs-keyword">for</span> a3 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>            c[<span class="hljs-number">11</span>]=t2[a3]<br>            <span class="hljs-keyword">for</span> a4 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                c[<span class="hljs-number">12</span>]=t3[a4]<br>                <span class="hljs-keyword">for</span> a5 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                    c[<span class="hljs-number">13</span>]=t3[a5]<br>                    <span class="hljs-keyword">for</span> a6 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                        c[<span class="hljs-number">14</span>]=t2[a6]<br>                        <span class="hljs-keyword">for</span> a7 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                            c[<span class="hljs-number">16</span>]=t3[a7]<br>                            <span class="hljs-keyword">for</span> a8 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                                c[<span class="hljs-number">17</span>]=t4[a8]<br>                                <span class="hljs-keyword">for</span> a9 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                                    c[<span class="hljs-number">19</span>]=t3[a9]<br>                                    <span class="hljs-keyword">for</span> a10 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                                        c[<span class="hljs-number">20</span>]=t1[a10]<br>                                        <span class="hljs-keyword">for</span> a11 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                                            c[<span class="hljs-number">25</span>]=t4[a11]<br>                                            <span class="hljs-keyword">for</span> a12 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                                                c[<span class="hljs-number">27</span>]=t3[a12]<br>                                                <span class="hljs-keyword">for</span> a13 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                                                    c[<span class="hljs-number">31</span>]=t3[a13]<br>                                                    <span class="hljs-keyword">for</span> a14 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                                                        c[<span class="hljs-number">32</span>]=t2[a14]<br>                                                        <span class="hljs-keyword">for</span> a15 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                                                            c[<span class="hljs-number">34</span>]=t5[a15]<br>                                                            <span class="hljs-keyword">for</span> a16 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                                                                c[<span class="hljs-number">37</span>]=t1[a16]<br>                                                                <span class="hljs-keyword">for</span> a17 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                                                                    c[<span class="hljs-number">38</span>]=t2[a17]<br>                                                                    <span class="hljs-keyword">for</span> a18 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>                                                                        c[<span class="hljs-number">46</span>]=t5[a18]<br>                                                                        <span class="hljs-keyword">for</span> a19 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                                                                            c[<span class="hljs-number">58</span>]=t1[a19]<br>                                                                            <span class="hljs-keyword">for</span> a20 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                                                                                c[<span class="hljs-number">61</span>]=t1[a20]<br>                                                                                dododo(c)<br><br><span class="hljs-comment">#NCTF{ADF0E239-D911-3781-7E40-A575A19E5835}</span><br></code></pre></td></tr></tbody></table></figure>
<p>题感觉都挺好玩的，就是把z3 ban掉太不够意思了，自己的算法能力不是太给力。</p>
<hr>
<p><strong>总结:C++或者再复杂一点的语言还得是动调，线程的调用关系要梳理清晰还有常见算法，同时巩固了一下西湖的SMC思路。</strong></p>
<blockquote>
<p>NCTF还是差一道Android就能AK了，native层的代码看的头皮发麻，有时间要及时复现和反思，另:航哥TQQQLLL，直接给秒了</p>
</blockquote>
<p><strong>加上安洵杯，上周小比赛还是蛮多的，能学到很多东西，但还没完全复现。最近临近考试周，实验和考试比较多，要去冲刺了，估计是最近两周不会再摸了。</strong></p>
<blockquote>
<p>别贪心，我们不会什么都有，别灰心，我们也不会什么都没有。让我们像个英勇的蒙古骑士一样，拿起手中锋利的马刀，去与更强大的敌人拼杀吧！</p>
</blockquote>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/CTF-Memory/">CTF Memory</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/RE/">RE</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/12/18/dp%E5%92%8Cdq%E6%B3%84%E9%9C%B2/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">RSA dp和dq泄露</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/11/21/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912021/">
                        <span class="hidden-mobile">西湖论剑2021-Re</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"dG9k0bNzTLa8ce8dJVPW6a1S-gzGzoHsz","appKey":"uNYvcLRBa89c21aI9qAO6BBi","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"https://dg9k0bnz.lc-cn-n1-shared.com","emojiCDN":null,"emojiMaps":null,"enableQQ":true},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          Fluid.plugins.initFancyBox('#valine .vcontent img:not(.vemoji)');
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js" ></script>
  
  
    <script  src="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js" ></script>
  
  
    <script defer src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js" ></script>
  






  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
