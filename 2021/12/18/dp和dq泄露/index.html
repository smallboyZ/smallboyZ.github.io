

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/QQ图片20211218184601.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Lu1u">
  <meta name="keywords" content="">
  
    <meta name="description" content="RSA-dp、dq泄露中因前提条件忽视而引发的非预期">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA dp和dq泄露">
<meta property="og:url" content="http://example.com/2021/12/18/dp%E5%92%8Cdq%E6%B3%84%E9%9C%B2/index.html">
<meta property="og:site_name" content="Lightu">
<meta property="og:description" content="RSA-dp、dq泄露中因前提条件忽视而引发的非预期">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/wallhaven-j3lqlw_u0iivg.jpg">
<meta property="article:published_time" content="2021-12-18T04:40:38.000Z">
<meta property="article:modified_time" content="2022-09-27T14:43:06.774Z">
<meta property="article:author" content="Lightu&#39;s Blog">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/wallhaven-j3lqlw_u0iivg.jpg">
  
  
  <title>RSA dp和dq泄露 - Lightu</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0,"placement":"right"},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"follow_dnt":true},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Lightu&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://blog-1309321804.cos.ap-nanjing.myqcloud.com/blog/wallhaven-l3v7pr.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="RSA dp和dq泄露">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-12-18 12:40" pubdate>
        2021年12月18日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      16k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      133 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">RSA dp和dq泄露</h1>
            
            <div class="markdown-body">
              <blockquote>
<p>从一个[羊城杯 2020]Power密码题，引发的关于dp 和 dq泄露等有趣的问题。</p>
</blockquote>
<p><strong>题目本身就出的有漏洞，并且对dp泄露的危害有了更深的理解。</strong></p>
<blockquote>
<p><strong>其中的数学基础主要基于费马定理和简单的数论推导,成立以m小于p为前提</strong></p>
</blockquote>
<h3 id="1、-羊城杯-2020-Power">1、[羊城杯 2020]Power</h3>
<p>题目如下</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p**<span class="hljs-number">4</span>*q<br><br>e = <span class="hljs-number">65537</span><br>phi = gmpy2.lcm(p - <span class="hljs-number">1</span>, q - <span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi)<br>dp = d % (p - <span class="hljs-number">1</span>)<br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">"dp = "</span> + <span class="hljs-built_in">str</span>(dp))<br><span class="hljs-built_in">print</span> (<span class="hljs-string">"c = "</span> + <span class="hljs-built_in">str</span>(c))<br><br>y = <span class="hljs-number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span><br><br>g = <span class="hljs-number">2</span><br>x = <span class="hljs-number">2019</span>*p**<span class="hljs-number">2</span> + <span class="hljs-number">2020</span>*p**<span class="hljs-number">3</span> + <span class="hljs-number">2021</span>*p**<span class="hljs-number">4</span><br>c1 = <span class="hljs-built_in">pow</span>(g, x, y)<br><span class="hljs-built_in">print</span>( <span class="hljs-string">"c1 = "</span> + <span class="hljs-built_in">str</span>(c1))<br><br><span class="hljs-comment"># dp = 379476973158146550831004952747643994439940435656483772269013081580532539640189020020958796514224150837680366977747272291881285391919167077726836326564473</span><br><br><span class="hljs-comment"># c = 57248258945927387673579467348106118747034381190703777861409527336272914559699490353325906672956273559867941402281438670652710909532261303394045079629146156340801932254839021574139943933451924062888426726353230757284582863993227592703323133265180414382062132580526658205716218046366247653881764658891315592607194355733209493239611216193118424602510964102026998674323685134796018596817393268106583737153516632969041693280725297929277751136040546830230533898514659714717213371619853137272515967067008805521051613107141555788516894223654851277785393355178114230929014037436770678131148140398384394716456450269539065009396311996040422853740049508500540281488171285233445744799680022307180452210793913614131646875949698079917313572873073033804639877699884489290120302696697425</span><br><br><span class="hljs-comment"># c1 = 78100131461872285613426244322737502147219485108799130975202429638042859488136933783498210914335741940761656137516033926418975363734194661031678516857040723532055448695928820624094400481464950181126638456234669814982411270985650209245687765595483738876975572521276963149542659187680075917322308512163904423297381635532771690434016589132876171283596320435623376283425228536157726781524870348614983116408815088257609788517986810622505961538812889953185684256469540369809863103948326444090715161351198229163190130903661874631020304481842715086104243998808382859633753938512915886223513449238733721777977175430329717970940440862059204518224126792822912141479260791232312544748301412636222498841676742208390622353022668320809201312724936862167350709823581870722831329406359010293121019764160016316259432749291142448874259446854582307626758650151607770478334719317941727680935243820313144829826081955539778570565232935463201135110049861204432285060029237229518297291679114165265808862862827211193711159152992427133176177796045981572758903474465179346029811563765283254777813433339892058322013228964103304946743888213068397672540863260883314665492088793554775674610994639537263588276076992907735153702002001005383321442974097626786699895993544581572457476437853778794888945238622869401634353220344790419326516836146140706852577748364903349138246106379954647002557091131475669295997196484548199507335421499556985949139162639560622973283109342746186994609598854386966520638338999059</span><br></code></pre></td></tr></tbody></table></figure>
<p>我们已知c，c1，dp，e 没有n，可能我们注意力比较容易被c1的约束所吸引。</p>
<p><strong>c1是由2^x mod y 生成的，其中x和p相关，y是一个非常大的数，如果没有模运算，一个简单log就能求出n， 在模运算下，这就上升为离散对数问题。</strong></p>
<p>我们可以通过sympy库的<code>discrete_log</code> 函数来求解，可p是一个512bit的数，X是非常大的，在5min左右python跑出，或许sagemath 会更快一点，这也要求之后要掌握一些有关离散对数的求解算法。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(sympy.discrete_log(y,c1,<span class="hljs-number">2</span>))<br></code></pre></td></tr></tbody></table></figure>
<p>参考用法:        <a target="_blank" rel="noopener" href="https://www.pythonf.cn/read/109392">https://www.pythonf.cn/read/109392</a></p>
<p>离散对数算法: <a target="_blank" rel="noopener" href="http://www.zbc53.top/archives/124/">http://www.zbc53.top/archives/124/</a></p>
<p><strong>假设 我们求出了X 之后X就是p的一个多次方程，可以用z3进行求解。</strong></p>
<p>求出p之后呢，我们还是没有n 并且没有q的相关信息，这时就要用到dp这一个条件。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python">dp= d mod p-<span class="hljs-number">1</span><br><span class="hljs-comment">#两遍同乘e</span><br>e*dp = e*d mod p -<span class="hljs-number">1</span> <br><span class="hljs-comment">#等价</span><br>e*dp = e*d + k*(p-<span class="hljs-number">1</span>)    (<span class="hljs-number">1</span>)<br><br><span class="hljs-string">"""</span><br><span class="hljs-string">根据我们钟爱的e*d = 1 mod phi n</span><br><span class="hljs-string"></span><br><span class="hljs-string">n= (p^4) *q</span><br><span class="hljs-string">phi(n) = (p^3)*(p-1)*q</span><br><span class="hljs-string"></span><br><span class="hljs-string">有了这些前提,不妨让式(1) mod phin</span><br><span class="hljs-string">"""</span><br>e*d + k*(p-<span class="hljs-number">1</span>) mod phin = e*dp <br><span class="hljs-comment">#等价</span><br><span class="hljs-number">1</span> + k*(p-<span class="hljs-number">1</span>) = e*dp +  k*phin    phin=(p^<span class="hljs-number">3</span>)*(p-<span class="hljs-number">1</span>)*q  也是k<span class="hljs-string">'*(p-1)</span><br><span class="hljs-string">#整理 也就是</span><br><span class="hljs-string">e*dp = 1 + k1*(p-1)     (2)    #感觉出其中的倍数关系即可</span><br><span class="hljs-string">#此处标位式(2) 我们之后会重点用到</span><br><span class="hljs-string"></span><br><span class="hljs-string">"""</span><br><span class="hljs-string">既然</span><br><span class="hljs-string">m ^ e = c mod n</span><br><span class="hljs-string">c^d mod n = m</span><br><span class="hljs-string">用到了欧拉定理</span><br><span class="hljs-string">a^(phin) mod n = 1 </span><br><span class="hljs-string"></span><br><span class="hljs-string">那么我们可以类似</span><br><span class="hljs-string">c ^ (dp) = m ^ (e*dp) = m ^ (1 + k1*(p-1))</span><br><span class="hljs-string">根据费马定理 a ^ (p-1) mod p = 1</span><br><span class="hljs-string">那么 c ^ dp  mod p = m</span><br><span class="hljs-string">"""</span><br><span class="hljs-string">c ^ dp  mod p = m</span><br></code></pre></td></tr></tbody></table></figure>
<p>根据上述推导，拿到p，游戏就结束了。</p>
<ul>
<li>
<p>上述  c ^ dp  mod p = m 必须要满足 m &lt; p 或者近似接近 否则近乎不能求解</p>
<p>即 m = (c^dp mod p) + k*p</p>
</li>
</ul>
<p><strong>回顾一下解题思路，我们执着于解离散对数和高次方程不就是为了求p么，但总结一下上面无论是dp还是 c1 都是有关p的，两个方程求一个未知量，是不是有点奢侈了呢?</strong></p>
<p><strong>注意推导中的这个式子e<em>dp = 1 + k1</em>(p-1)！！！ e和dp已知，k未知但是 e<em>dp - 1 一定是 (p-1)的整数倍，并且e</em>dp-1为525个bit 是十分接近的，这完全可以爆破。</strong></p>
<p>脚本如下</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span>  gmpy2<br><span class="hljs-keyword">import</span> cmath<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">from</span>  Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e = <span class="hljs-number">65537</span><br>dp=<span class="hljs-number">379476973158146550831004952747643994439940435656483772269013081580532539640189020020958796514224150837680366977747272291881285391919167077726836326564473</span><br>c=<span class="hljs-number">57248258945927387673579467348106118747034381190703777861409527336272914559699490353325906672956273559867941402281438670652710909532261303394045079629146156340801932254839021574139943933451924062888426726353230757284582863993227592703323133265180414382062132580526658205716218046366247653881764658891315592607194355733209493239611216193118424602510964102026998674323685134796018596817393268106583737153516632969041693280725297929277751136040546830230533898514659714717213371619853137272515967067008805521051613107141555788516894223654851277785393355178114230929014037436770678131148140398384394716456450269539065009396311996040422853740049508500540281488171285233445744799680022307180452210793913614131646875949698079917313572873073033804639877699884489290120302696697425</span><br>ep=e*dp-<span class="hljs-number">1</span><br><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-number">1000000</span>):<br>    <span class="hljs-keyword">if</span> ep % k ==<span class="hljs-number">0</span>:<br>        p = (ep//k) +<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> isPrime(p):<br>            <span class="hljs-built_in">print</span>(k)<br><br>p=<span class="hljs-number">12131601165788024635030034921084070470053842112984866821070395281728468805072716002494427632757418621194662541766157553264889658892783635499016425528807741</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,dp,p)))<br></code></pre></td></tr></tbody></table></figure>
<p><strong>这样也能达到解出p的目的，并且直接用 pow(c,dp,p),求解，用到了两个二级推导结论。</strong></p>
<p><strong>这也能透露出当m&lt;p时e*dp泄露的危害，如果能通过dp爆破出p，或者直接拿到p ，则直接用dp 和 p，作为私钥和公钥解密即可。</strong></p>
<p><strong>dp，dq本身就是为了快速解密服务的，也就决定了，大多情况下的p和q是非常大的，往往m会比p要小很多，如果出题人在dp泄露时忽视了这一点，那么可能会出现非预期。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#在m&gt;&gt;p 的dp泄露就需要给出e和n，以便我们借助p来分解n</span><br><span class="hljs-comment">#以网上的一个题目为例</span><br>(<span class="hljs-string">'dp='</span>, <span class="hljs-string">'0x7f1344a0b8d2858492aaf88d692b32c23ef0d2745595bc5fe68de384b61c03e8fd054232f2986f8b279a0105b7bee85f74378c7f5f35c3fd505e214c0738e1d9'</span>)<br>(<span class="hljs-string">'n='</span>, <span class="hljs-string">'0x5eee1b4b4f17912274b7427d8dc0c274dc96baa72e43da36ff39d452ff6f2ef0dc6bf7eb9bdab899a6bb718c070687feff517fcf5377435c56c248ad88caddad6a9cefa0ca9182daffcc6e48451d481f37e6520be384bedb221465ec7c95e2434bf76568ef81e988039829a2db43572e2fe57e5be0dc5d94d45361e96e14bd65L'</span>)<br>(<span class="hljs-string">'e='</span>, <span class="hljs-string">'0x10001'</span>)<br>(<span class="hljs-string">'c='</span>, <span class="hljs-string">'0x510fd8c3f6e21dfc0764a352a2c7ff1e604e1681a3867480a070a480f722e2f4a63ca3d7a92b862955ab4be76cde43b51576a128fba49348af7a6e34b335cfdbda8e882925b20503762edf530d6cd765bfa951886e192b1e9aeed61c0ce50d55d11e343c78bb617d8a0adb7b4cf3b913ee85437191f1136e35b94078e68bee8dL'</span>)<br></code></pre></td></tr></tbody></table></figure>
<h4 id="1、p-m-Quic-Crack">1、p&lt;m Quic Crack</h4>
<p><strong>p的位数可以直接观察dp得出，接近512bit，64字节，一般flag在30-50左右甚至更短，即m&lt;p</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span>  gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>dp=<span class="hljs-number">0x7f1344a0b8d2858492aaf88d692b32c23ef0d2745595bc5fe68de384b61c03e8fd054232f2986f8b279a0105b7bee85f74378c7f5f35c3fd505e214c0738e1d9</span><br><br>n=<span class="hljs-number">0x5eee1b4b4f17912274b7427d8dc0c274dc96baa72e43da36ff39d452ff6f2ef0dc6bf7eb9bdab899a6bb718c070687feff517fcf5377435c56c248ad88caddad6a9cefa0ca9182daffcc6e48451d481f37e6520be384bedb221465ec7c95e2434bf76568ef81e988039829a2db43572e2fe57e5be0dc5d94d45361e96e14bd65</span><br>e=<span class="hljs-number">0x10001</span><br>c=<span class="hljs-number">0x510fd8c3f6e21dfc0764a352a2c7ff1e604e1681a3867480a070a480f722e2f4a63ca3d7a92b862955ab4be76cde43b51576a128fba49348af7a6e34b335cfdbda8e882925b20503762edf530d6cd765bfa951886e192b1e9aeed61c0ce50d55d11e343c78bb617d8a0adb7b4cf3b913ee85437191f1136e35b94078e68bee8d</span><br>edp=e*dp - <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-number">10000000</span>):<br>    <span class="hljs-keyword">if</span> edp%k==<span class="hljs-number">0</span>:<br>        p= edp//k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> isPrime(p):<br>            <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,dp,p)))<br></code></pre></td></tr></tbody></table></figure>
<p>当然这只是一种特殊情况，但是网上大多数关于dp泄露题目貌似都存在这个问题。</p>
<h4 id="2、通用解法">2、通用解法</h4>
<p><strong>通解，当然rsa加密对密文本身就限制了m是要比n小的</strong></p>
<p>所以分解n直接解就得了，既然上脚本我们已经测试出了p ，那么q = n//p 即可。</p>
<p>综上，综合两种脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span>  gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>dp=<span class="hljs-number">0x7f1344a0b8d2858492aaf88d692b32c23ef0d2745595bc5fe68de384b61c03e8fd054232f2986f8b279a0105b7bee85f74378c7f5f35c3fd505e214c0738e1d9</span><br><br>n=<span class="hljs-number">0x5eee1b4b4f17912274b7427d8dc0c274dc96baa72e43da36ff39d452ff6f2ef0dc6bf7eb9bdab899a6bb718c070687feff517fcf5377435c56c248ad88caddad6a9cefa0ca9182daffcc6e48451d481f37e6520be384bedb221465ec7c95e2434bf76568ef81e988039829a2db43572e2fe57e5be0dc5d94d45361e96e14bd65</span><br>e=<span class="hljs-number">0x10001</span><br>c=<span class="hljs-number">0x510fd8c3f6e21dfc0764a352a2c7ff1e604e1681a3867480a070a480f722e2f4a63ca3d7a92b862955ab4be76cde43b51576a128fba49348af7a6e34b335cfdbda8e882925b20503762edf530d6cd765bfa951886e192b1e9aeed61c0ce50d55d11e343c78bb617d8a0adb7b4cf3b913ee85437191f1136e35b94078e68bee8d</span><br>edp=e*dp - <span class="hljs-number">1</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-number">10000000</span>):<br>    <span class="hljs-keyword">if</span> edp%k==<span class="hljs-number">0</span>:<br>        p= edp//k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> isPrime(p):<br>            <span class="hljs-keyword">try</span>:<br>                <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,dp,p)).decode(<span class="hljs-string">'utf-8'</span>)) <span class="hljs-comment">#flag肯定是可见字符</span><br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">'Quick Crack Suc!'</span>)<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">except</span>:<br>                q=n//p<br>                phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>                d=gmpy2.invert(e,phi)<br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)).decode(<span class="hljs-string">'utf-8'</span>))<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">'yes!'</span>)<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">except</span>:<br>                    <span class="hljs-keyword">pass</span><br></code></pre></td></tr></tbody></table></figure>
<p><strong>测试，用如下式例来测试 m &gt; p的情况</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">dp = <span class="hljs-number">14423533367739841601650555272663543354837347609362352488761411482549189398193</span><br>p =  <span class="hljs-number">69901287164206610888661720099426949703910023683707793762919220907478091073681</span><br>c=  <span class="hljs-number">2262919207276468849681578487794992281448594044416435512543882157738828978766101685798623343531305619235784170849036103143665025760464116190980363198608567</span><br>e=<span class="hljs-number">65537</span><br>n=<span class="hljs-number">5965322435025945026021165385608956120433036321627501574655956870755806607342365635361310529607383516087208412532082338428923031616470920911896483167491881</span><br></code></pre></td></tr></tbody></table></figure>
<h3 id="2、dp-dq泄露">2、dp dq泄露</h3>
<p><strong>dp 和 dq泄露 和dp泄露有着异曲同工之妙，不过忽略了m &lt; p / q 就成了纸老虎。</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">c: <span class="hljs-number">95272795986475189505518980251137003509292621140166383887854853863720692420204142448424074834657149326853553097626486371206617513769930277580823116437975487148956107509247564965652417450550680181691869432067892028368985007229633943149091684419834136214793476910417359537696632874045272326665036717324623992885</span><br>p: <span class="hljs-number">11387480584909854985125335848240384226653929942757756384489381242206157197986555243995335158328781970310603060671486688856263776452654268043936036556215243</span><br>q: <span class="hljs-number">12972222875218086547425818961477257915105515705982283726851833508079600460542479267972050216838604649742870515200462359007315431848784163790312424462439629</span><br>dp: <span class="hljs-number">8191957726161111880866028229950166742224147653136894248088678244548815086744810656765529876284622829884409590596114090872889522887052772791407131880103961</span><br>dq: <span class="hljs-number">3570695757580148093370242608506191464756425954703930236924583065811730548932270595568088372441809535917032142349986828862994856575730078580414026791444659</span><br></code></pre></td></tr></tbody></table></figure>
<p>按之前的算法 是要用中国剩余定理求d的</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">dp = d mod p-<span class="hljs-number">1</span><br>dq = d mod q-<span class="hljs-number">1</span><br></code></pre></td></tr></tbody></table></figure>
<h4 id="1、解密思路-Crt">1、解密思路 + Crt</h4>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">m1 = c^dp mod p<br>m2 = c^dq mod q<br>dp = d mod p-<span class="hljs-number">1</span>   -&gt; dp = d + k*(p-<span class="hljs-number">1</span>)<br>dq = q mod q-<span class="hljs-number">1</span><br><span class="hljs-comment">#根据 费马可得 c^dp mod p = c^d mod p</span><br><span class="hljs-comment">#同理 c^dq mod q = c^d mod q </span><br>c^d mod p = m1<br>c^d mod q = m2<br><br>构造 x = k1*m1 + k2*m2<br><br>(<span class="hljs-number">1</span>)k1 mod p =<span class="hljs-number">1</span><br>(<span class="hljs-number">2</span>)k1 mod q =<span class="hljs-number">0</span><br><br>k1 = k*q 带入(<span class="hljs-number">1</span>)<br>k = q^(-<span class="hljs-number">1</span>) mod p <br>即 k1 = (q ^(-<span class="hljs-number">1</span>) mod p) *q<br><br><span class="hljs-string">"""</span><br><span class="hljs-string">推广到一般 如果 在剩余定理中</span><br><span class="hljs-string">x mod a1 = b1 </span><br><span class="hljs-string">x mod a2 = b2</span><br><span class="hljs-string">x mod a3 = b3</span><br><span class="hljs-string">...</span><br><span class="hljs-string"></span><br><span class="hljs-string">那么构造的数 m = k1*b1 + k2*b2 + ... kn * bn</span><br><span class="hljs-string">k1 = ((a2 *a3 *..an)^(-1) mod a1) * (a2 *a3 *..an)</span><br><span class="hljs-string">k2 = ((a1 *a3 *..an)^(-1) mod a1) * (a2 *a3 *..an)</span><br><span class="hljs-string"><span class="hljs-meta">... </span>如此规律</span><br><span class="hljs-string">M=a1*a2*..an</span><br><span class="hljs-string">Mi = M / ai</span><br><span class="hljs-string">Mi' = gmpy2.invert(Mi,ai)</span><br><span class="hljs-string">Mi * Mi' * bi 每一项</span><br><span class="hljs-string">综合要%M  一下</span><br><span class="hljs-string">"""</span><br><br></code></pre></td></tr></tbody></table></figure>
<p>即</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span>  gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>dp= <span class="hljs-number">90494486973243104756298311175705002887155440121025946664275790548694955799661434870163629541771658812502682012435200659355928618529521731475360236486362525996535354732687624609637012830178545914960485330748345108757203508531117591067570383564779625954776907685968592668868046507450242047759226407026094726359</span><br>dq= <span class="hljs-number">92386717102324384872139253931247976320472847834037799716676564640678692924258053130751618730959510913784801723023536527134208843358920592320351399005428347188639433875570867152865970587272904695272790831679276818402117343413503376057524788386479263579869430615501089905630519162146030369086836183772975252551</span><br>p= <span class="hljs-number">121869669684596731118740111360803257498670698122183387353481580136405322481841982461820301261370579505460038281590785837096967719889404913176714663774999789266522508163678949469953184327222227297952119212490499582581953510522212981687122483764873187827531047946130999532741388680549345732675732040579796067001</span><br>q= <span class="hljs-number">128363031923139297392077349407719417788135630403499671848196425800900870531452570499668481104884553795224784931947824885511134525485570129640119439950191944938407656926280993408854767711557863016197167505998324659906146937423415404059310560359693643987781862684489401368519777953281060013045590132161625607377</span><br>c= <span class="hljs-number">4176193749773450562408160796325873473193702511560805285554329767573726211097194419198463203488792792756598428753745425419950423161673497255820731183746106463781291156892140581651301528184812357534808298071893380519977926677138246941946185699346532140641376461516107672722425971178865758049759985915001009787241295292157744353554548314911531918044654676691927347018033509499136103964942830581407087547565204232556314726045307279963709599952745342811947421707024572981812906869557834491207590418553244020621858083633564878305733114484857827620268881100166090837841224767358579366482347136224695333980041913268394994302</span><br>m1 = <span class="hljs-built_in">pow</span>(c,dp,p)<br>m2 = <span class="hljs-built_in">pow</span>(c,dq,q)<br>d = gmpy2.invert(q,p)*(q)*m1 + gmpy2.invert(p,q)*(p)*m2<br><br><span class="hljs-built_in">print</span>(long_to_bytes(d%(p*q)))<br></code></pre></td></tr></tbody></table></figure>
<p>用python的库sympy来实现crt</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy.ntheory.modular <span class="hljs-keyword">import</span> * <span class="hljs-comment">#从sympy数论库中导入函数</span><br>crt([p,q],[m1,m2])<br><span class="hljs-comment"># 第一个参数是模数组，第二个参数是余数组</span><br><span class="hljs-comment"># 返回值是一个元组 第一个数是求解的m值，第二个数是所有模数的乘积</span><br><br>m=crt([p,q],[m1,m2])[<span class="hljs-number">0</span>] <span class="hljs-comment">#得到解即可</span><br><span class="hljs-built_in">print</span>(long_to_bytes(m%n))<br></code></pre></td></tr></tbody></table></figure>
<p>sympy库中有很多方便的函数，有大致印象百度即可。</p>
<h4 id="2、测试用例">2、测试用例</h4>
<p>反例当messaege&gt;q</p>
<p>注意m要小于n</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span>  gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p=getPrime(<span class="hljs-number">256</span>)<br>q=getPrime(<span class="hljs-number">256</span>)<br>n=p*q<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>e=<span class="hljs-number">65537</span><br>d=gmpy2.invert(e,phi)<br>dp=d%(p-<span class="hljs-number">1</span>)<br>dq=d%(q-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">'dp = '</span>,dp)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">'p = '</span>,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">'dq = '</span>,dq)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">'q= '</span>,q)<br>m=<span class="hljs-string">b'flag{If_the message_is_larger_than_prime_end!!!}'</span><br>c=bytes_to_long(m)<br>c= <span class="hljs-built_in">pow</span>(c,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">'c= '</span>,c)<br></code></pre></td></tr></tbody></table></figure>
<p>如果继续解密,则是乱码</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>dp = <span class="hljs-number">14423533367739841601650555272663543354837347609362352488761411482549189398193</span><br>p =  <span class="hljs-number">69901287164206610888661720099426949703910023683707793762919220907478091073681</span><br>c=  <span class="hljs-number">2262919207276468849681578487794992281448594044416435512543882157738828978766101685798623343531305619235784170849036103143665025760464116190980363198608567</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,dp,p)))<br><span class="hljs-comment"># b'Y\x83^\xa4\xf2\xbaC\xbfY\xa0\x9a!\x07^\xb0\x12\xaa-\xa0\x10\xf8;\x9b\xb1\xaaF5\x9f\xb2\x952\xc0'</span><br></code></pre></td></tr></tbody></table></figure>
<p>中国剩余定理,成功解决</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span>  gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>dp =  <span class="hljs-number">14423533367739841601650555272663543354837347609362352488761411482549189398193</span><br>p =  <span class="hljs-number">69901287164206610888661720099426949703910023683707793762919220907478091073681</span><br>dq =  <span class="hljs-number">32437946587531699347725552012753985094383131578752766354933176932787801620073</span><br>q=  <span class="hljs-number">85339235900086908600694050911639754370783480963298143334400691126173744722201</span><br>c=  <span class="hljs-number">2262919207276468849681578487794992281448594044416435512543882157738828978766101685798623343531305619235784170849036103143665025760464116190980363198608567</span><br>m1 = <span class="hljs-built_in">pow</span>(c,dp,p)<br>m2 = <span class="hljs-built_in">pow</span>(c,dq,q)<br>d = gmpy2.invert(q,p)*(q)*m1 + gmpy2.invert(p,q)*(p)*m2<br><br><span class="hljs-built_in">print</span>(long_to_bytes(d%(p*q)))<br><span class="hljs-comment">#b'flag{If_the message_is_larger_than_prime_end!!!}'</span><br></code></pre></td></tr></tbody></table></figure>
<hr>
<blockquote>
<p>推导过程中的中间结论也能对解密有巨大贡献，在进行加密时，还要考虑密文和素因数以及模数的大小，防止出现非预期的漏洞。</p>
</blockquote>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Crypto/">Crypto</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Crypto/">Crypto</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/12/31/PinTool-DBI%E5%88%A9%E7%94%A8/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">PinTool-DBI技术利用</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/12/01/2021NCTF-RE/">
                        <span class="hidden-mobile">2021NCTF-Re</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js" ></script>
  
  
    <script  src="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js" ></script>
  
  
    <script defer src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js" ></script>
  






  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
